<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Reading Test - Code 3</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- jsPDF library for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- jsPDF AutoTable plugin for table generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <style>
        /* Custom styles for better readability and aesthetics */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
            color: #333;
            overflow: hidden; /* Prevent body scroll */
        }
        .main-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        .content-wrapper {
            display: flex;
            flex-direction: row;
            flex-grow: 1;
            overflow: hidden;
        }
        .passage-half, .questions-half {
            width: 50%;
            overflow-y: auto;
            padding: 1.5rem;
        }
        .passage-half {
            border-right: 2px solid #e5e7eb;
        }

        @media (max-width: 1024px) {
            .content-wrapper {
                flex-direction: column;
            }
            .passage-half, .questions-half {
                width: 100%;
                height: 50%;
                border-right: none;
            }
            .passage-half {
                border-bottom: 2px solid #e5e7eb;
            }
        }

        .question-group {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
        }
        .question-group:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        /* Input styles for different question types */
        .tfng-btn-group .btn {
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            background-color: #f9fafb;
        }
        .tfng-btn-group .btn.selected {
            background-color: #4f46e5;
            color: white;
            border-color: #4f46e5;
        }
        .short-answer-input {
            width: 100%;
            max-width: 250px;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            transition: border-color 0.2s;
        }
        .short-answer-input:focus {
            outline: none;
            border-color: #4f46e5;
        }
        .dropdown-select {
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background-color: white;
        }

        /* Tab specific styles */
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            flex-shrink: 0;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            border: 1px solid #e5e7eb;
            background-color: #e2e8f0;
            color: #4a5568;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border-radius: 0.5rem;
            margin: 0 0.25rem;
        }
        .tab-button.active {
            background-color: #4f46e5;
            color: white;
            border-color: #4f46e5;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; height: 100%; }
        
        /* Highlight styles */
        .highlight-toolbar {
            position: absolute;
            background-color: #1f2937;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
        }
        .highlight-toolbar button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 5px;
        }
        mark {
            background-color: #fef08a;
            padding: 0.1em 0.2em;
            border-radius: 0.2em;
        }
        .frozen-form {
            pointer-events: none;
            opacity: 0.7;
        }
        .timer-container {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            padding: 0.5rem;
            background-color: #e0f2fe;
            color: #0c4a6e;
            border-bottom: 1px solid #e5e7eb;
            flex-shrink: 0;
        }
        .timer-container.ended {
            background-color: #fecaca;
            color: #991b1b;
        }
    </style>
</head>
<body class="p-0 sm:p-0 md:p-0">

    <!-- Highlight Toolbar -->
    <div id="highlight-toolbar" class="highlight-toolbar">
        <button id="highlight-btn">Highlight</button>
    </div>

    <div class="max-w-full mx-auto bg-white rounded-xl shadow-lg main-container">
        <div class="p-4 border-b">
            <h1 class="text-2xl md:text-3xl font-extrabold text-center text-indigo-700">IELTS Reading Test - Code 3</h1>
        </div>
        
        <!-- Timer Display -->
        <div id="timer-container" class="timer-container">
            Time Remaining: <span id="countdown">60:00</span>
        </div>

        <!-- Tab Buttons -->
        <div class="tabs p-4">
            <button class="tab-button active" onclick="openTab(event, 'passage1')">Passage 1</button>
            <button class="tab-button" onclick="openTab(event, 'passage2')">Passage 2</button>
            <button class="tab-button" onclick="openTab(event, 'passage3')">Passage 3</button>
        </div>

        <div class="content-wrapper">
            <!-- Passage Half (Left) -->
            <div class="passage-half">
                <!-- Passage 1 Text -->
                <div id="passage1-text" class="tab-content active">
                    <h3 class="text-xl font-bold text-indigo-600 mb-4">Henry Moore (1898-1986)</h3>
                    <div class="text-gray-700 leading-relaxed space-y-4 selectable-text">
                        <p>Henry Moore was born in Castleford, a small town near Leeds in the north of England. He was the seventh child of Raymond Moore and his wife Mary Baker. He studied at Castleford Grammar School from 1909 to 1915, where his early interest in art was encouraged by his teacher Alice Gostick. After leaving school, Moore hoped to become a sculptor, but instead he complied with his father’s wish that he train as a schoolteacher. He had to abandon his training in 1917 when he was sent to France to fight in the First World War.</p>
                        <p>After the war, Moore enrolled at the Leeds School of Art, where he studied for two years. In his first year, he spent most of his time drawing. Although he wanted to study sculpture, no teacher was appointed until his second year. At the end of that year, he passed the sculpture examination and was awarded a scholarship to the Royal College of Art in London. In September 1921, he moved to London and began three years of advanced study in sculpture.</p>
                        <p>Alongside the instruction he received at the Royal College, Moore visited many of the London museums, particularly the British Museum, which had a wide-ranging collection of ancient sculpture. During these visits, he discovered the power and beauty of ancient Egyptian and African sculpture. As he became increasingly interested in these ‘primitive’ forms of art, he turned away from European sculptural traditions.</p>
                        <p>After graduating, Moore spent the first six months of 1925 travelling in France. When he visited the Trocadero Museum in Paris, he was impressed by a cast of a Mayan* sculpture of the rain spirit. It was a male reclining figure with its knees drawn up together, and its head at a right angle to its body. Moore became fascinated with this stone sculpture, which he thought had a power and originality that no other stone sculpture possessed. He himself started carving a variety of subjects in stone, including depiction of reclining women, mother-and-child groups, and masks.</p>
                        <p>Moore’s exceptional talent soon gained recognition, and in 1926 he started work as a sculpture instructor at the Royal College. In 1933, he became a member of a group of young artists called Unit One. The aim of the group was to convince the English public of the merits of the emerging international movement in modern art and architecture.</p>
                        <p>Around this time, Moore moved away from the human figure to experiment with abstract shapes. In 1931, he held an exhibition at the Leicester Galleries in London. His work was enthusiastically welcomed by fellow sculptors, but the reviews in the press were extremely negative and turned Moore into a notorious figure. There were calls for his resignation from the Royal College, and the following year, when his contract expired, he left to start a sculpture department at the Chelsea School of Art in London.</p>
                        <p>Throughout the 1930s, Moore did not show any inclination to please the British public. He became interested in the paintings of the Spanish artist Pablo Picasso, whose work inspired him to distort the human body in a radical way. At times, he seemed to abandon the human figure altogether. The pages of his sketchbooks from this period show his ideas for abstract sculptures that bore little resemblance to the human form.</p>
                        <p>In 1940, during the Second World War, Moore stopped teaching at the Chelsea School and moved to a farmhouse about 20 miles north of London. A shortage of materials forced him to focus on drawing. He did numerous small sketches of Londoners, later turning these ideas into large coloured drawings in his studio. In 1942, he returned to Castleford to make a series of sketches of the miners who worked there.</p>
                        <p>In 1944, Harlow, a town near London, offered Moore a commission for a sculpture depicting a family. The resulting work signifies a dramatic change in Moore’s style, away from the experimentation of the 1930s towards a more natural and humanistic subject matter. He did dozens of studies in clay for the sculpture, and these were cast in bronze and issued in editions of seven to nine copies each. In this way, Moore’s work became available to collectors all over the world. The boost to his income enabled him to take on ambitious projects and start working on the scale he felt his sculpture demanded.</p>
                        <p>Critics who had begun to think that Moore had become less revolutionary were proven wrong by the appearance, in 1950, of the first of Moore’s series of standing figures in bronze, with their harsh and angular pierced forms and distinct impression of menace. Moore also varied his subject matter in the 1950s with such works as Warrior with Shield and Falling Warrior. These were rare examples of Moore’s use of the male figure and owe something to his visit to Greece in 1951, when he had the opportunity to study ancient works of art.</p>
                        <p>In his final years, Moore created the Henry Moore Foundation to promote art appreciation and to display his work. Moore was the first modern English sculptor to achieve international critical acclaim and he is still regarded as one of the most important sculptors of the 20th century.</p>
                        <p class="text-sm italic">*Mayan: belonging to an ancient civilisation that inhabited parts of current-day Mexico, Guatemala, Belize, El Salvador and Honduras.</p>
                    </div>
                </div>
                 <!-- Passage 2 Text -->
                <div id="passage2-text" class="tab-content">
                     <h3 class="text-xl font-bold text-indigo-600 mb-4">The Desolenator: producing clean water</h3>
                    <div class="text-gray-700 leading-relaxed space-y-4 selectable-text">
                        <p><b>A</b> Travelling around Thailand in the 1990s, William Janssen was impressed with the basic rooftop solar heating systems that were on many homes, where energy from the sun was absorbed by a plate and then used to heat water for domestic use. Two decades later Janssen developed that basic idea he saw in Southeast Asia into a portable device that uses the power from the sun to purify water.</p>
                        <p><b>B</b> The Desolenator operates as a mobile desalination unit that can take water from different places, such as the sea, rivers, boreholes and rain, and purify it for human consumption. It is particularly valuable in regions where natural groundwater reserves have been polluted, or where seawater is the only water source available. Janssen saw that there was a need for a sustainable way to clean water is both the developing and the developed countries when he moved to the United Arab Emirates and saw large-scale water processing. ‘I was confronted with the enormous carbon footprint that the Gulf nations have because of all of the desalination that they do,’ he says.</p>
                        <p><b>C</b> The Desolenator can produce 15 litres of drinking water per day, enough to sustain a family for cooking and drinking. Its main selling point is that unlike standard desalination techniques, it doesn’t require a generated power supply: just sunlight. It measures 120 cm by 90 cm, and it easy to transport, thanks to its two wheels. Water enters through a pipe, and flows as a thin film between a sheet of double glazing and the surface of a solar panel, where it is heated by the sun. the warm water flows into a small boiler (heated by a solar-powered battery) where it is converted to steam. When the steam cools, it becomes distilled water. The device has a very simple filter to trap particles, and this can easily be shaken to remove them. There are two tubes for liquid coming out: one for the waste – salt from seawater, fluoride, etc. – and another for the distilled water. The performance of the unit is shown on an LCD screen and transmitted to the company which provides servicing when necessary.</p>
                        <p><b>D</b> A recent analysis found that at least two-thirds of the world’s population lives with severe water scarcity for at least a month every year. Janssen says that be 2030 half of the world’s population will be living with water stress – where the demand exceeds the supply over a certain period of time. ‘It is really important that a sustainable solution is brought to the market that is able to help these people,’ he says. Many countries ‘don’t have the money for desalination plants, which are very expensive to build. They don’t have the money to operate them, they are very maintenance intensive, and they don’t have the money to buy the diesel to run the desalination plants, so it is a really bad situation.’</p>
                        <p><b>E</b> The device is aimed at a wide variety of users – from homeowners in the developing world who do not have a constant supply of water to people living off the grid in rural parts of the US. The first commercial versions of the Desolenator are expected to be in operation in India early next year, after field tests are carried out. The market for the self-sufficient devices in developing countries is twofold – those who cannot afford the money for the device outright and pay through microfinance, and middle-income homes that can lease their own equipment. ‘People in India don’t pay for a fridge outright; they pay for it over six months. They would put the Desolenator on their roof and hook it up to their municipal supply and they would get very reliable drinking water on a daily basis,’ Janssen says. In the developed world, it is aimed at niche markets where tap water is unavailable – for camping, on boats, or for the military, for instance.</p>
                        <p><b>F</b> Prices will vary according to where it is bought. In the developing world, the price will depend on what deal aid organisations can negotiate. In developed countries, it is likely to come in at $1,000 (£685) a unit, said Janssen. ‘We are a venture with a social mission. We are aware that the product we have envisioned is mainly finding application in the developing world and humanitarian sector and that this is the way we will proceed. We do realise, though, that to be a viable company there is a bottom line to keep in mind,’ he says.</p>
                        <p><b>G</b> The company itself is based at Imperial College London, although Janssen, its chief executive, still lives in the UAE. It has raised £340,000 in funding so far. Within two years, he says, the company aims to be selling 1,000 units a month, mainly in the humanitarian field. They are expected to be sold in areas such as Australia, northern Chile, Peru, Texas and California.</p>
                    </div>
                </div>
                 <!-- Passage 3 Text -->
                <div id="passage3-text" class="tab-content">
                    <h3 class="text-xl font-bold text-indigo-600 mb-4">Why fairy tales are really scary tales</h3>
                    <div class="text-gray-700 leading-relaxed space-y-4 selectable-text">
                         <p>People of every culture tell each other fairy tales but the same story often takes a variety of forms in different parts of the world. In the story of Little Red Riding Hood that European children are familiar with, a young girl on the way to see her grandmother meets a wolf and tells him where she is going. The wolf runs on ahead and disposes of the grandmother, then gets into bed dressed in the grandmother’s clothes to wait for Little Red Riding Hood. You may think you know the story – but which version? In some versions, the wolf swallows up the grandmother, while in others it locks her in a cupboard. In some stories Red Riding Hood gets the better of the wolf on her own, while in others a hunter or a woodcutter hears her cries and comes to her rescue.</p>
                        <p>The universal appeal of these tales is frequently attributed to the idea that they contain cautionary messages: in the case of Little Red Riding Hood, to listen to your mother, and avoid talking to strangers. ‘It might be what we find interesting about this story is that it’s got this survival-relevant information in it,’ says anthropologist Jamie Tehrani at Durham University in the UK. But his research suggests otherwise. ‘We have this huge gap in our knowledge about the history and prehistory of storytelling, despite the fact that we know this genre is an incredibly ancient one,’ he says. That hasn’t stopped anthropologists, folklorists* and other academics devising theories to explain the importance of fairy tales in human society. Now Tehrani has found a way to test these ideas, borrowing a technique from evolutionary biologists.</p>
                        <p>To work out the evolutionary history, development and relationships among groups of organisms, biologists compare the characteristics of living species in a process called ‘phylogenetic analysis’. Tehrani has used the same approach to compare related versions of fairy tales to discover how they have evolved and which elements have survived longest.</p>
                        <p>Tehrani’s analysis focused on Little Red Riding Hood in its many forms, which include another Western fairy tale known as The Wolf and the Kids. Checking for variants of these two tales and similar stories from Africa, East Asia and other regions, he ended up with 58 stories recorded from oral traditions. Once his phylogenetic analysis had established that they were indeed related, he used the same methods to explore how they have developed and altered over time.</p>
                        <p>First he tested some assumptions about which aspects of the story alter least as it evolves, indicating their importance. Folklorists believe that what happens in a story is more central to the story than the characters in it – that visiting a relative, only to be met by a scary animal in disguise, is more fundamental than whether the visitor is a little girl or three siblings, or the animal is a tiger instead of a wolf.</p>
                        <p>However, Tehrani found no significant difference in the rate of evolution of incidents compared with that of characters. ‘Certain episodes are very stable because they are crucial to the story, but there are lots of other details that can evolve quite freely,’ he says. Neither did his analysis support the theory that the central section of a story is the most conserved part. He found no significant difference in the flexibility of events there compared with the beginning or the end.</p>
                        <p>But the really big surprise came when he looked at the cautionary elements of the story. ‘Studies on hunter-gatherer folk tales suggest that these narratives include really important information about the environment and the possible dangers that may be faced there – stuff that’s relevant to survival,’ he says. Yet in his analysis such elements were just as flexible as seemingly trivial details. What, then, is important enough to be reproduced from generation to generation?</p>
                        <p>The answer, it would appear, is fear – blood-thirsty and gruesome aspects of the story, such as the eating of the grandmother by the wolf, turned out to be the best preserved of all. Why are these details retained by generations of storytellers, when other features are not? Tehrani has an idea: ‘In an oral context, a story won’t survive because of one great teller. It also needs to be interesting when it’s told by someone who’s not necessarily a great storyteller.’ Maybe being swallowed whole by a wolf, then cut out of its stomach alive is so gripping that it helps the story remain popular, no matter how badly it’s told.</p>
                        <p>Jack Zipes at the University of Minnesota, Minneapolis, is unconvinced by Tehrani’s views on fairy tales. ‘Even if they’re gruesome, they won’t stick unless they matter,’ he says. He believes the perennial theme of women as victims in stories like Little Red Riding Hood explains why they continue to feel relevant. But Tehrani points out that although this is often the case in Western versions, it is not always true elsewhere. In Chinese and Japanese versions, often known as The Tiger Grandmother, the villain is a woman, and in both Iran and Nigeria, the victim is a boy.</p>
                        <p>Mathias Clasen at Aarhus University in Denmark isn’t surprised by Tehrani’s findings. ‘Habits and morals change, but the things that scare us, and the fact that we seek out entertainment that’s designed to scare us – those are constant,’ he says. Clasen believes that scary stories teach us what it feels like to be afraid without having to experience real danger, and so build up resistance to negative emotions.</p>
                        <p class="text-sm italic">*Folklorists: those who study traditional stories</p>
                    </div>
                </div>
            </div>

            <!-- Questions Half (Right) -->
            <div class="questions-half">
                <!-- Passage 1 Questions -->
                <div id="passage1-questions" class="tab-content active">
                     <form id="form1">
                        <div class="question-group">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Questions 1-7</h4>
                            <p class="mb-4 selectable-text">Do the following statements agree with the claims of the writer? Write TRUE, FALSE, or NOT GIVEN.</p>
                            <div class="space-y-4">
                                <!-- Q1 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>1</b> On leaving school, Moore did what his father wanted him to do.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q1">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                                <!-- Q2 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>2</b> Moore began studying sculpture in his first term at the Leeds School of Art.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q2">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                                <!-- Q3 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>3</b> When Moore started at the Royal College of Art, its reputation for teaching sculpture was excellent.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q3">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                                 <!-- Q4 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>4</b> Moore became aware of ancient sculpture as a result of visiting London Museums.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q4">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                                 <!-- Q5 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>5</b> The Trocadero Museum’s Mayan sculpture attracted a lot of public interest.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q5">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                                 <!-- Q6 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>6</b> Moore thought the Mayan sculpture was similar in certain respects to other stone sculptures.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q6">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                                 <!-- Q7 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>7</b> The artists who belonged to Unit One wanted to make modern art and architecture more popular.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q7">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="question-group">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Questions 8-13</h4>
                            <p class="mb-4 selectable-text">Complete the notes below. Choose <b>ONE WORD ONLY</b> from the passage for each answer.</p>
                            <div class="space-y-4 selectable-text">
                                <h5 class="font-bold">Moore’s career as an artist</h5>
                                <p><b>1930s</b></p>
                                <ul class="list-disc list-inside ml-4 space-y-3">
                                    <li>Moore’s exhibition at the Leicester Galleries is criticised by the press</li>
                                    <li>Moore is urged to offer his <b>8</b> <input type="text" name="q8" class="short-answer-input"> and leave the Royal College.</li>
                                </ul>
                                <p><b>1940s</b></p>
                                <ul class="list-disc list-inside ml-4 space-y-3">
                                    <li>Moore turns to drawing because <b>9</b> <input type="text" name="q9" class="short-answer-input"> for sculpting are not readily available</li>
                                    <li>While visiting his hometown, Moore does some drawings of <b>10</b> <input type="text" name="q10" class="short-answer-input"></li>
                                    <li>Moore is employed to produce a sculpture of a <b>11</b> <input type="text" name="q11" class="short-answer-input"></li>
                                    <li><b>12</b> <input type="text" name="q12" class="short-answer-input"> start to buy Moore’s work</li>
                                    <li>Moore’s increased <b>13</b> <input type="text" name="q13" class="short-answer-input"> makes it possible for him to do more ambitious sculptures</li>
                                </ul>
                                 <p><b>1950s</b></p>
                                 <ul class="list-disc list-inside ml-4 space-y-3">
                                     <li>Moore’s series of bronze figures marks a further change in his style</li>
                                 </ul>
                            </div>
                        </div>
                    </form>
                </div>
                <!-- Passage 2 Questions -->
                <div id="passage2-questions" class="tab-content">
                    <form id="form2">
                        <div class="question-group">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Questions 14-20</h4>
                            <p class="mb-4 selectable-text">The reading passage has seven paragraphs, A-G. Choose the correct heading for each section from the list of headings below.</p>
                            <div class="mb-4 p-3 bg-gray-50 rounded-lg selectable-text">
                                <p class="font-bold mb-2">List of Headings</p>
                                <ul class="list-none space-y-1 text-sm">
                                    <li><b>i</b> Getting the finance for production</li>
                                    <li><b>ii</b> An unexpected benefit</li>
                                    <li><b>iii</b> From initial inspiration to new product</li>
                                    <li><b>iv</b> The range of potential customers for the device</li>
                                    <li><b>v</b> What makes the device different from alternatives</li>
                                    <li><b>vi</b> Cleaning water from a range of sources</li>
                                    <li><b>vii</b> Overcoming production difficulties</li>
                                    <li><b>viii</b> Profit not the primary goal</li>
                                    <li><b>ix</b> A warm welcome for the device</li>
                                    <li><b>x</b> The number of people affected by water shortages</li>
                                </ul>
                            </div>
                            <div class="space-y-3">
                                <div class="flex items-center space-x-3"><b>14</b> Section A <select name="q14" class="dropdown-select"><option value="">Select</option><option value="i">i</option><option value="ii">ii</option><option value="iii">iii</option><option value="iv">iv</option><option value="v">v</option><option value="vi">vi</option><option value="vii">vii</option><option value="viii">viii</option><option value="ix">ix</option><option value="x">x</option></select></div>
                                <div class="flex items-center space-x-3"><b>15</b> Section B <select name="q15" class="dropdown-select"><option value="">Select</option><option value="i">i</option><option value="ii">ii</option><option value="iii">iii</option><option value="iv">iv</option><option value="v">v</option><option value="vi">vi</option><option value="vii">vii</option><option value="viii">viii</option><option value="ix">ix</option><option value="x">x</option></select></div>
                                <div class="flex items-center space-x-3"><b>16</b> Section C <select name="q16" class="dropdown-select"><option value="">Select</option><option value="i">i</option><option value="ii">ii</option><option value="iii">iii</option><option value="iv">iv</option><option value="v">v</option><option value="vi">vi</option><option value="vii">vii</option><option value="viii">viii</option><option value="ix">ix</option><option value="x">x</option></select></div>
                                <div class="flex items-center space-x-3"><b>17</b> Section D <select name="q17" class="dropdown-select"><option value="">Select</option><option value="i">i</option><option value="ii">ii</option><option value="iii">iii</option><option value="iv">iv</option><option value="v">v</option><option value="vi">vi</option><option value="vii">vii</option><option value="viii">viii</option><option value="ix">ix</option><option value="x">x</option></select></div>
                                <div class="flex items-center space-x-3"><b>18</b> Section E <select name="q18" class="dropdown-select"><option value="">Select</option><option value="i">i</option><option value="ii">ii</option><option value="iii">iii</option><option value="iv">iv</option><option value="v">v</option><option value="vi">vi</option><option value="vii">vii</option><option value="viii">viii</option><option value="ix">ix</option><option value="x">x</option></select></div>
                                <div class="flex items-center space-x-3"><b>19</b> Section F <select name="q19" class="dropdown-select"><option value="">Select</option><option value="i">i</option><option value="ii">ii</option><option value="iii">iii</option><option value="iv">iv</option><option value="v">v</option><option value="vi">vi</option><option value="vii">vii</option><option value="viii">viii</option><option value="ix">ix</option><option value="x">x</option></select></div>
                                <div class="flex items-center space-x-3"><b>20</b> Section G <select name="q20" class="dropdown-select"><option value="">Select</option><option value="i">i</option><option value="ii">ii</option><option value="iii">iii</option><option value="iv">iv</option><option value="v">v</option><option value="vi">vi</option><option value="vii">vii</option><option value="viii">viii</option><option value="ix">ix</option><option value="x">x</option></select></div>
                            </div>
                        </div>
                        <div class="question-group">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Questions 21-26</h4>
                            <p class="mb-4 selectable-text">Complete the summary below. Choose <b>ONE WORD ONLY</b> from the passage for each answer.</p>
                            <div class="space-y-3 p-4 bg-gray-50 rounded-lg selectable-text">
                                <h5 class="font-bold text-center mb-2">How the Desolenator works</h5>
                                <p>The energy required to operate the Desolenator comes from sunlight. The device can be used in different locations, as it has <b>21</b> <input type="text" name="q21" class="short-answer-input">. Water is fed into a pipe, and a <b>22</b> <input type="text" name="q22" class="short-answer-input"> of water flows over a solar panel. The water then enters a boiler, where it turns into steam. Any particles in the water are caught in a <b>23</b> <input type="text" name="q23" class="short-answer-input">. The purified water comes out through one tube, and all types of <b>24</b> <input type="text" name="q24" class="short-answer-input"> come out through another. A screen displays the <b>25</b> <input type="text" name="q25" class="short-answer-input"> of the device, and transmits the information to the company so that they know when the Desolenator requires <b>26</b> <input type="text" name="q26" class="short-answer-input">.</p>
                            </div>
                        </div>
                    </form>
                </div>
                <!-- Passage 3 Questions -->
                <div id="passage3-questions" class="tab-content">
                    <form id="form3">
                        <div class="question-group">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Questions 27-31</h4>
                            <p class="mb-4 selectable-text">Complete each sentence with the correct ending, A-F, below.</p>
                            <div class="mb-4 p-3 bg-gray-50 rounded-lg selectable-text">
                                <ul class="list-none space-y-1 text-sm">
                                    <li><b>A</b> may be provided through methods used in biological research.</li>
                                    <li><b>B</b> are the reason for their survival.</li>
                                    <li><b>C</b> show considerable global variation.</li>
                                    <li><b>D</b> contain animals which transform to become humans.</li>
                                    <li><b>E</b> were originally spoken rather than written.</li>
                                    <li><b>F</b> have been developed without factual basis.</li>
                                </ul>
                            </div>
                            <div class="space-y-3 selectable-text">
                                <div class="flex items-center space-x-3"><b>27</b> In fairy tales, details of the plot <select name="q27" class="dropdown-select"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select></div>
                                <div class="flex items-center space-x-3"><b>28</b> Tehrani rejects the idea that the useful lessons for life in fairy tales <select name="q28" class="dropdown-select"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select></div>
                                <div class="flex items-center space-x-3"><b>29</b> Various theories about the social significance of fairy tales <select name="q29" class="dropdown-select"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select></div>
                                <div class="flex items-center space-x-3"><b>30</b> Insights into the development of fairy tales <select name="q30" class="dropdown-select"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select></div>
                                <div class="flex items-center space-x-3"><b>31</b> All the fairy tales analysed by Tehrani <select name="q31" class="dropdown-select"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select></div>
                            </div>
                        </div>
                        <div class="question-group">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Questions 32-36</h4>
                            <p class="mb-4 selectable-text">Complete the summary using the list of words, A-I, below.</p>
                             <div class="mb-4 p-3 bg-gray-50 rounded-lg selectable-text">
                                <div class="grid grid-cols-3 gap-1 text-sm">
                                    <span><b>A</b> ending</span> <span><b>B</b> events</span> <span><b>C</b> warning</span>
                                    <span><b>D</b> links</span> <span><b>E</b> records</span> <span><b>F</b> variations</span>
                                    <span><b>G</b> horror</span> <span><b>H</b> people</span> <span><b>I</b> plot</span>
                                </div>
                            </div>
                            <div class="space-y-3 p-4 bg-gray-50 rounded-lg selectable-text">
                                <h5 class="font-bold text-center mb-2">Phylogenetic analysis of Little Red Riding Hood</h5>
                                <p>Tehrani used techniques from evolutionary biology to find out if <b>32</b> <select name="q32" class="dropdown-select"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option></select> existed among 58 stories from around the world. He also wanted to know which aspects of the stories had fewest <b>33</b> <select name="q33" class="dropdown-select"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option></select>, as he believed these aspects would be the most important ones. Contrary to other beliefs, he found that some <b>34</b> <select name="q34" class="dropdown-select"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option></select> that were included in a story tended to change over time, and that the middle of a story seemed no more important than the other parts. He was also surprised that parts of a story which seemed to provide some sort of <b>35</b> <select name="q35" class="dropdown-select"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option></select> were unimportant. The aspect that he found most important in a story’s survival was <b>36</b> <select name="q36" class="dropdown-select"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option></select></p>
                            </div>
                        </div>
                         <div class="question-group">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Questions 37-40</h4>
                            <p class="mb-4 selectable-text">Choose the correct letter, A, B, C or D.</p>
                            <div class="space-y-4">
                                <!-- Q37 -->
                                <div class="question-item">
                                    <p class="font-medium mb-2 selectable-text">37 What method did Jamie Tehrani use to test his ideas about fairy tales?</p>
                                    <label class="block selectable-text"><input type="radio" name="q37" value="A" class="mr-2">A He compared oral and written forms of the same stories.</label>
                                    <label class="block selectable-text"><input type="radio" name="q37" value="B" class="mr-2">B He looked at many different forms of the same basic story.</label>
                                    <label class="block selectable-text"><input type="radio" name="q37" value="C" class="mr-2">C He looked at unrelated stories from many different countries.</label>
                                    <label class="block selectable-text"><input type="radio" name="q37" value="D" class="mr-2">D He contrasted the development of fairy tales with that of living creatures.</label>
                                </div>
                                <!-- Q38 -->
                                <div class="question-item">
                                    <p class="font-medium mb-2 selectable-text">38 When discussing Tehrani’s views, Jack Zipes suggests that</p>
                                    <label class="block selectable-text"><input type="radio" name="q38" value="A" class="mr-2">A Tehrani ignores key changes in the role of women.</label>
                                    <label class="block selectable-text"><input type="radio" name="q38" value="B" class="mr-2">B stories which are too horrific are not always taken seriously.</label>
                                    <label class="block selectable-text"><input type="radio" name="q38" value="C" class="mr-2">C Tehrani overemphasises the importance of violence in stories.</label>
                                    <label class="block selectable-text"><input type="radio" name="q38" value="D" class="mr-2">D features of stories only survive if they have a deeper significance.</label>
                                </div>
                                <!-- Q39 -->
                                <div class="question-item">
                                    <p class="font-medium mb-2 selectable-text">39 Why does Tehrani refer to Chinese and Japanese fairy tales?</p>
                                    <label class="block selectable-text"><input type="radio" name="q39" value="A" class="mr-2">A to indicate that Jack Zipes’ theory is incorrect</label>
                                    <label class="block selectable-text"><input type="radio" name="q39" value="B" class="mr-2">B to suggest that crime is a global problem</label>
                                    <label class="block selectable-text"><input type="radio" name="q39" value="C" class="mr-2">C to imply that all fairy tales have a similar meaning</label>
                                    <label class="block selectable-text"><input type="radio" name="q39" value="D" class="mr-2">D to add more evidence for Jack Zipes’ ideas</label>
                                </div>
                                <!-- Q40 -->
                                <div class="question-item">
                                    <p class="font-medium mb-2 selectable-text">40 What does Mathias Clasen believe about fairy tales?</p>
                                    <label class="block selectable-text"><input type="radio" name="q40" value="A" class="mr-2">A They are a safe way of learning to deal with fear.</label>
                                    <label class="block selectable-text"><input type="radio" name="q40" value="B" class="mr-2">B They are a type of entertainment that some people avoid.</label>
                                    <label class="block selectable-text"><input type="radio" name="q40" value="C" class="mr-2">C They reflect the changing values of our society.</label>
                                    <label class="block selectable-text"><input type="radio" name="q40" value="D" class="mr-2">D They reduce our ability to deal with real-world problems.</label>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="flex justify-center p-4 border-t">
            <button type="button" id="submit-test-button" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg shadow-xl transition-colors duration-300 text-lg">Submit Test</button>
        </div>
    </div>

    <script>
        // Store correct answers for each form
        const correctAnswers = {
            form1: {
                q1: 'TRUE', q2: 'FALSE', q3: 'NOT GIVEN', q4: 'TRUE', q5: 'NOT GIVEN', q6: 'FALSE', q7: 'TRUE',
                q8: 'resignation', q9: 'materials', q10: 'miners', q11: 'family', q12: 'collectors', q13: 'income'
            },
            form2: {
                q14: 'iii', q15: 'vi', q16: 'v', q17: 'x', q18: 'iv', q19: 'viii', q20: 'i',
                q21: 'wheels', q22: 'film', q23: 'filter', q24: 'waste', q25: 'performance', q26: 'servicing'
            },
            form3: {
                q27: 'C', q28: 'B', q29: 'F', q30: 'A', q31: 'E',
                q32: 'D', q33: 'F', q34: 'B', q35: 'C', q36: 'G',
                q37: 'B', q38: 'D', q39: 'A', q40: 'A'
            }
        };
        
        // Store user answers
        const userAnswers = {};
        let timerInterval;
        let savedRange;

        // Tab functionality
        function openTab(evt, passageId) {
            document.querySelectorAll('.passage-half .tab-content, .questions-half .tab-content').forEach(content => content.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));
            document.getElementById(passageId + '-text').classList.add('active');
            document.getElementById(passageId + '-questions').classList.add('active');
            evt.currentTarget.classList.add('active');
        }

        // Highlight functionality
        const toolbar = document.getElementById('highlight-toolbar');
        const highlightButton = document.getElementById('highlight-btn');

        document.addEventListener('mouseup', (e) => {
            const selection = window.getSelection();
            if (selection.rangeCount > 0 && !selection.isCollapsed && e.target.closest('.selectable-text')) {
                savedRange = selection.getRangeAt(0).cloneRange();
                const rect = savedRange.getBoundingClientRect();
                toolbar.style.left = `${rect.left + window.scrollX + rect.width / 2 - toolbar.offsetWidth / 2}px`;
                toolbar.style.top = `${rect.top + window.scrollY - toolbar.offsetHeight - 5}px`;
                toolbar.style.display = 'block';
            } else {
                setTimeout(() => {
                    if (!toolbar.matches(':hover')) {
                       toolbar.style.display = 'none';
                    }
                }, 100);
            }
        });

        highlightButton.addEventListener('mousedown', (e) => { // Use mousedown to prevent losing selection
            e.preventDefault(); // Prevent the button from taking focus
            if (savedRange) {
                const mark = document.createElement('mark');
                try {
                    savedRange.surroundContents(mark);
                } catch (ex) {
                    console.error("Could not wrap the selection, it might span across non-contiguous elements.", ex);
                }
                window.getSelection().removeAllRanges();
                savedRange = null;
            }
            toolbar.style.display = 'none';
        });

        // TFNG Button Group Logic
        document.querySelectorAll('.tfng-btn-group').forEach(group => {
            group.addEventListener('click', (e) => {
                if (e.target.classList.contains('btn')) {
                    const question = group.dataset.question;
                    const value = e.target.dataset.value;
                    userAnswers[question] = value;
                    group.querySelectorAll('.btn').forEach(btn => btn.classList.remove('selected'));
                    e.target.classList.add('selected');
                }
            });
        });

        // Store answers from text inputs, dropdowns, and radio buttons on change
        document.querySelectorAll('input[type="text"], select, input[type="radio"]').forEach(input => {
            input.addEventListener('change', (e) => {
                userAnswers[e.target.name] = e.target.value;
            });
        });

        function collectAllAnswers() {
            const allUserAnswers = {};
            let totalCorrect = 0;
            let totalQuestions = 0;

            for (const formId in correctAnswers) {
                for (const qName in correctAnswers[formId]) {
                    const questionNumber = parseInt(qName.substring(1));
                    const correctAnswer = correctAnswers[formId][qName];
                    const userAnswer = userAnswers[qName] || 'N/A';
                    
                    let isCorrect = (typeof correctAnswer === 'string' && typeof userAnswer === 'string' && userAnswer.trim().toLowerCase() === correctAnswer.trim().toLowerCase());

                    if (isCorrect) {
                        totalCorrect++;
                    }

                    allUserAnswers[questionNumber] = {
                        userAnswer: userAnswer,
                        correctAnswer: correctAnswer,
                        status: isCorrect ? 'Correct' : 'Incorrect'
                    };
                    totalQuestions++;
                }
            }
            return { allUserAnswers, totalCorrect, totalQuestions };
        }

        function generatePdfReport() {
            const results = collectAllAnswers();
            const { allUserAnswers, totalCorrect, totalQuestions } = results;
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.setFontSize(22);
            doc.text("IELTS Reading Test Results", 105, 20, null, null, "center");
            doc.setFontSize(12);
            doc.text(`Total Score: ${totalCorrect} out of ${totalQuestions} correct`, 14, 35);

            const tableColumn = ["Q#", "Your Answer", "Correct Answer", "Status"];
            const tableRows = [];
            const sortedQuestionNumbers = Object.keys(allUserAnswers).sort((a, b) => a - b);

            sortedQuestionNumbers.forEach(qNum => {
                const data = allUserAnswers[qNum];
                tableRows.push([qNum, data.userAnswer, data.correctAnswer, data.status]);
            });

            doc.autoTable({
                head: [tableColumn],
                body: tableRows,
                startY: 45,
                theme: 'grid',
                headStyles: { fillColor: [44, 62, 80], textColor: [255, 255, 255], fontStyle: 'bold' },
                didDrawCell: (data) => {
                    if (data.section === 'body' && data.column.index === 3) {
                        if (data.cell.raw === 'Correct') doc.setTextColor(34, 139, 34);
                        else if (data.cell.raw === 'Incorrect') doc.setTextColor(220, 20, 60);
                    }
                }
            });
            return doc;
        }
        
        function freezeAllForms() {
             document.querySelectorAll('form').forEach(form => form.classList.add('frozen-form'));
             document.getElementById('submit-test-button').disabled = true;
        }

        function endTest() {
            clearInterval(timerInterval);
            const timerContainer = document.getElementById('timer-container');
            timerContainer.textContent = "Time's Up!";
            timerContainer.classList.add('ended');
            const doc = generatePdfReport();
            doc.save('IELTS_Reading_Test_3_Results.pdf');
            freezeAllForms();
        }

        function startTimer() {
            let timeLeft = 60 * 60; // 60 minutes in seconds
            const countdownEl = document.getElementById('countdown');

            timerInterval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                countdownEl.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

                if (timeLeft <= 0) {
                    endTest();
                }
            }, 1000);
        }

        document.getElementById('submit-test-button').addEventListener('click', endTest);
        
        document.addEventListener('DOMContentLoaded', startTimer);

    </script>
</body>
</html>
