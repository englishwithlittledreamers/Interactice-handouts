<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Passage: Interactive Worksheet</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #ffffff; /* Changed to white */
        }
        /* Style for disabled radio buttons */
        input[type='radio'].form-radio:disabled {
            opacity: 0.7; /* Make them slightly faded when disabled */
            cursor: not-allowed;
        }

        /* Style for radio buttons */
        input[type='radio'].form-radio {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            display: inline-block;
            vertical-align: middle;
            background-origin: border-box;
            user-select: none;
            flex-shrink: 0;
            border-radius: 100%;
            height: 1.25em;
            width: 1.25em;
            border: 2px solid #D1D5DB; /* gray-300 */
            background-color: #F9FAFB; /* gray-50 */
            transition: all 0.2s ease-in-out;
        }
        input[type='radio'].form-radio:checked {
            border-color: transparent;
            background-color: currentColor;
            background-size: 100% 100%;
            background-position: center;
            background-repeat: no-repeat;
            background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3ccircle cx='8' cy='8' r='3'/%3e%3c/svg%3e");
        }
        input[type='radio'].form-radio:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.45); /* blue-500 with opacity */
        }

        /* Style for disabled checkboxes (not used in current version, but kept for consistency) */
        input[type='checkbox'].form-checkbox:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        /* Style for checkboxes (not used in current version, but kept for consistency) */
        input[type='checkbox'].form-checkbox {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            display: inline-block;
            vertical-align: middle;
            background-origin: border-box;
            user-select: none;
            flex-shrink: 0;
            border-radius: 0.25rem; /* square corners */
            height: 1.25em;
            width: 1.25em;
            border: 2px solid #D1D5DB; /* gray-300 */
            background-color: #F9FAFB; /* gray-50 */
            transition: all 0.2s ease-in-out;
        }
        input[type='checkbox'].form-checkbox:checked {
            border-color: transparent;
            background-color: currentColor;
            background-size: 100% 100%;
            background-position: center;
            background-repeat: no-repeat;
            background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 24 24' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z'/%3e%3c/svg%3e"); /* checkmark */
        }
        input[type='checkbox'].form-checkbox:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.45); /* blue-500 with opacity */
        }

        /* Ensure input fields don't wrap text onto the next line awkwardly (not used for this version) */
        .input-container {
            display: flex;
            flex-wrap: wrap; /* Allow wrapping for small screens */
            align-items: center;
            gap: 0.5rem; /* Space between elements */
        }
        .input-container input[type="text"] {
            flex-grow: 1; /* Allow input to grow */
            min-width: 150px; /* Minimum width for input */
        }
        /* Highlight styles */
        .highlight-yellow { background-color: #FEF9C3; } /* Yellow-100 */
        .highlight-blue { background-color: #DBEAFE; } /* Blue-100 */
        .highlight-green { background-color: #D1FAE5; } /* Green-100 */
        .highlight-pink { background-color: #FCE7F3; } /* Pink-100 */
        .highlighted-text {
            /* Ensures highlighted text is treated as a single unit for selection */
            display: inline;
        }

        /* Adjust for very small screens if necessary */
        @media (max-width: 640px) {
            .input-container {
                flex-direction: column;
                align-items: flex-start;
            }
            .input-container input {
                width: 100%; /* Full width on small screens */
            }
            /* Adjusted for various question types to ensure stacking on small screens */
            .question-container .options-row {
                flex-direction: column;
                align-items: flex-start;
                margin-left: 0;
                padding-left: 2rem;
            }
            .question-container select,
            .question-container input[type="text"] {
                width: 100%; /* Full width on small screens */
            }
        }
        /* Specific style for cloze text blanks to ensure they are inline with text */
        .cloze-text-blank {
            display: inline-flex;
            align-items: baseline;
            margin-left: 0.5em;
            margin-right: 0.5em;
        }
        .cloze-text-blank select {
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 2px 5px;
            font-size: inherit;
            vertical-align: baseline;
            min-width: 80px; /* Ensure dropdown is wide enough */
        }
        .cloze-passage-paragraph {
            display: block; /* Ensure paragraph breaks lines */
            margin-bottom: 1em;
            line-height: 1.6;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-white p-6 sm:p-8 md:p-10 rounded-xl  w-full max-w-4xl border border-gray-200">
       

        <div id="dictationContent" class="space-y-8 text-gray-700 text-base sm:text-lg leading-relaxed select-text">

            <!-- Section I: Cloze Test 1-5 -->
            <h2 class="text-1xl sm:text-1xl font-bold text-gray-800 mt-6 mb-4">
                I. Read the following passage and mark the letter A, B, C or D on your answer sheet to indicate the option that best fits each of the numbered blanks from 1 to 5.
            </h2>
            <p class="cloze-passage-paragraph">
                All holidays involve some element of risk, whether in the form of illness, bad weather, being unable to get what we want if we delay booking, or
                <span class="cloze-text-blank">
                    <select id="clozeQuestion1" data-question-number="1" data-correct-answer="D" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                        <option value="">Choose...</option>
                        <option value="A">A. for a certain product to be seen directly</option>
                        <option value="B">B. what are the products we will be certainly seeing directly</option>
                        <option value="C">C. until we certainly see its products directly</option>
                        <option value="D">D. being uncertain about the product until seeing it directly</option>
                    </select>
                </span>.
                We ask ourselves what risks we would run if we went there, if there is a high likelihood of their occurrence, if the risks are avoidable and how significant the consequences would be.
            </p>
            <p class="cloze-passage-paragraph">
                Some tourists, of course, relish a degree of risk, as this gives an edge of excitement to the holiday,
                <span class="cloze-text-blank">
                    <select id="clozeQuestion2" data-question-number="2" data-correct-answer="C" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                        <option value="">Choose...</option>
                        <option value="A">A. but do not present any risks and barriers to tourism itself</option>
                        <option value="B">B. if the barrier of tourism itself is not in the presence of risk</option>
                        <option value="C">C. so the presence of risk is not in itself a barrier to tourism</option>
                        <option value="D">D. and tourism itself does not present any barriers or risks</option>
                    </select>
                </span>.
                Others, however, are risk averse and will studiously avoid risk wherever possible. Clearly, the significance of the risk will be a key factor.
                <span class="cloze-text-blank">
                    <select id="clozeQuestion3" data-question-number="3" data-correct-answer="A" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                        <option value="">Choose...</option>
                        <option value="A">A. As a result, there will be much less concern about the risk of poor weather than about the risk of crime</option>
                        <option value="B">B. Similarly, the concern about the risk of poor weather will be much greater than that about the risk of crime</option>
                        <option value="C">C. As earlier mentioned, the risk of crime will be of much greater concern to people than that of poor weather</option>
                        <option value="D">D. People, by contrast, will be far less concerned about the risk of crime than about that of poor weather</option>
                    </select>
                </span>,
                the risk averse will book early, choose to return to the same resort and hotel they have visited, knowing its reliability, or book a package tour rather than travel independently.
            </p>
            <p class="cloze-passage-paragraph">
                <span class="cloze-text-blank">
                    <select id="clozeQuestion4" data-question-number="4" data-correct-answer="C" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                        <option value="">Choose...</option>
                        <option value="A">A. Holidays are also booked after customers choose factors and methods without risk</option>
                        <option value="B">B. Customers also book their holidays by choosing the methods without risky factors</option>
                        <option value="C">C. Risk is also a factor in the methods chosen by customers to book their holidays</option>
                        <option value="D">D. Also, the factors and methods customers choose to book their holidays are risky</option>
                    </select>
                </span>,
                there is evidence that much of the continuing reluctance shown by some tourists to seek information and make bookings through Internet providers can be attributed to, in part, the lack of face-to-face contact with a trusted – and, hopefully, expert – travel agent and, in part,
                <span class="cloze-text-blank">
                    <select id="clozeQuestion5" data-question-number="5" data-correct-answer="A" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                        <option value="">Choose...</option>
                        <option value="A">A. the suspicion that information received through the Internet will be biased</option>
                        <option value="B">B. due to the Internet, through which biased and suspicious information is received</option>
                        <option value="C">C. the biased information received through the Internet will be suspicious</option>
                        <option value="D">D. thanks to the biased information received through the Internet with the suspicion</option>
                    </select>
                </span>.
            </p>

            <!-- Section II: Reading Comprehension 6-13 -->
            <h2 class="text-1xl sm:text-1xl font-bold text-gray-800 mt-8 mb-4">
                II. Read the passage and mark the letter A, B, C or D on your answer sheet to indicate the best answer to each of the following questions from 6 to 13.
            </h2>
            <p class="text-base sm:text-lg text-gray-600 mb-4">
                The concept of project farming, where farmers come together to collaborate on large-scale agricultural projects, has gained significant traction, and modern technology keeps this collaboration on track. Advanced technologies such as GPS, sensors, drones, and data analytics are used to optimise agricultural practices. Additionally, the collected real-time data on soil conditions, weather patterns, and plant growth enables farmers to accelerate the decision-making process that maximises productivity while minimising resource wastage.
            </p>
            <p class="text-base sm:text-lg text-gray-600 mb-4">
                GPS technology allows farmers to precisely map out their fields and create customised planting plans. This ensures that seeds are sown at optimal locations based on soil characteristics and previous yield data. By avoiding areas with poor fertility, farmers can increase their overall crop yield. Camera traps provide advance warnings of insects, so farmers do not have to treat the whole field. This, therefore, helps curb chemical runoff and save money for every party involved in the project.
            </p>
            <p class="text-base sm:text-lg text-gray-600 mb-4">
                Technology also plays a vital role in optimising irrigation practices for sustainable agriculture. Specialised equipment reports dryness hour by hour, and weather apps forecast rain for the week ahead. Automated valves give each zone exactly the water it needs and pause when clouds are approaching. This cuts pumping costs and protects groundwater while keeping the crop healthy. On dry continents, such savings keep projects economically viable.
            </p>
            <p class="text-base sm:text-lg text-gray-600 mb-4">
                The digital trail does not stop at the farm gate. Cloud platforms let project farmers, processors, and truck drivers input harvest weights, storage temperatures, and delivery times the moment they change, while blockchain records freeze each entry so customers can trust it. Analytic tools combine seasons of records to forecast demand, spot price opportunities, and mark weak points in the workflow. This allows project farmers to anticipate market demand, exploit resource allocation, and plan for potential challenges.
            </p>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="6" data-correct-answer="B">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">6</span>
                    <p class="flex-grow">Which of the following is NOT mentioned in paragraph 1 as a type of collected real-time data?</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc6" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. plant growth</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc6" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. data analytics</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc6" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. soil conditions</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc6" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. weather patterns</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="7" data-correct-answer="D">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">7</span>
                    <p class="flex-grow">The word accelerate in paragraph 1 can be best replaced by ________.</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc7" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. guide</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc7" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. require</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc7" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. install</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc7" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. speed</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="8" data-correct-answer="A">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">8</span>
                    <p class="flex-grow">The word curb in paragraph 2 is OPPOSITE in meaning to ________.</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc8" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. increase</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc8" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. monitor</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc8" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. reduce</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc8" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. limit</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="9" data-correct-answer="C">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">9</span>
                    <p class="flex-grow">The word it in paragraph 3 refers to ________.</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc9" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. week</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc9" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. equipment</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc9" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. zone</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc9" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. dryness</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="10" data-correct-answer="B">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">10</span>
                    <p class="flex-grow">Which of the following best paraphrases the underlined sentence in paragraph 3?</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc10" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. Projects in dry regions are feasible because of the huge budget gained from applying smart irrigation.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc10" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. Money saved thanks to smart irrigation maintains the economic practicality of projects in dry areas.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc10" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. Continents with dry climate are the most likely to enjoy financial benefits from smart irrigation projects.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc10" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. In places with hot weather, economic projects are possible with money saved from smart irrigation.</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="11" data-correct-answer="A">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">11</span>
                    <p class="flex-grow">Which of the following is TRUE according to paragraph 4?</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc11" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. With the help of analytic tools, project farmers can anticipate market demand.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc11" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. Customers tend to find the entries frozen by blockchain records untrustworthy.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc11" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. The digital trail would stop after the project partners have gathered their harvest.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc11" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. Cloud platforms allow processors to predict demand for the following seasons.</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="12" data-correct-answer="C">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">12</span>
                    <p class="flex-grow">Which paragraph mentions real-time tracking of produce?</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc12" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. Paragraph 1</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc12" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. Paragraph 2</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc12" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. Paragraph 4</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc12" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. Paragraph 3</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="13" data-correct-answer="C">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">13</span>
                    <p class="flex-grow">Which paragraph mentions a preventive measure against biological threats?</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc13" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. Paragraph 4</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc13" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. Paragraph 3</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc13" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. Paragraph 2</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc13" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. Paragraph 1</span>
                    </label>
                </div>
            </div>

            <!-- Section III: Mark the letter A, B, C or D on your answer sheet to indicate the best arrangement of utterances or sentences -->
            <h2 class="text-1xl sm:text-1xl font-bold text-gray-800 mt-8 mb-4">
                III. Mark the letter A, B, C or D on your answer sheet to indicate the best arrangement of utterances or sentences to make a cohesive and coherent exchange or text in each of the following questions from 14 to 18.
            </h2>

            <div class="arrangement-question border-b border-gray-200 pb-4 pt-4" data-question-number="14" data-correct-answer="C">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">14</span>
                    <div class="flex-grow">
                        <p>a. Marvelli has now become a more dynamic and prosperous city, offering greater opportunities for both residents and investors.</p>
                        <p>b. These vital improvements have notably boosted Marvelli’s economy, fostering the growth of local businesses and attracting foreign investment.</p>
                        <p>c. To accommodate this growth, city planners have replaced the older terraced housing with modern high-rise buildings and expanded public facilities such as schools and hospitals.</p>
                        <p>d. Recognising the increasing traffic congestion, the city council has had the main roads widened and an intelligent traffic monitoring system installed to optimise traffic flow.</p>
                        <p>e. Over the past decade, the city of Marvelli has undergone a considerable transformation, experiencing an upsurge in population and an overload on the existing transport infrastructure.</p>
                    </div>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement14" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. a – b – d – e – c</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-600" name="arrangement14" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. e – d – c – a – b</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement14" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. e – c – d – b – a</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement14" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. a – d – b – c – e</span>
                    </label>
                </div>
            </div>

            <div class="arrangement-question border-b border-gray-200 pb-4 pt-4" data-question-number="15" data-correct-answer="A">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">15</span>
                    <div class="flex-grow">
                        <p>a. Susan: I exercise regularly by jogging, swimming or doing martial arts. How about you?</p>
                        <p>b. Susan: That sounds great! I think daily exercise and a healthy diet are the key to staying healthy.</p>
                        <p>c. Louis: I do yoga at home every day, and I follow a low-fat diet.</p>
                        <p>d. Louis: You look awesome. What do you do to keep fit?</p>
                        <p>e. Louis: Absolutely! Physical well-being is essential for a happy life.</p>
                    </div>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement15" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. d – a – c – b – e</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement15" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. c – a – d – b – e</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement15" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. e – a – d – b – c</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement15" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. d – c – b – e – a</span>
                    </label>
                </div>
            </div>

            <div class="arrangement-question border-b border-gray-200 pb-4 pt-4" data-question-number="16" data-correct-answer="C">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">16</span>
                    <div class="flex-grow">
                        <p>a. Mary: Thank you very much for your help!</p>
                        <p>b. John: Well, keep straight on to the roundabout, then take the second exit on the left. It’s a big building with a red roof on your right.</p>
                        <p>c. Mary: Excuse me, could you show me the way to the public library?</p>
                    </div>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement16" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. c – a – b</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement16" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. a – b – c</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement16" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. c – b – a</span>
                    </label>
                </div>
            </div>

            <div class="arrangement-question border-b border-gray-200 pb-4 pt-4" data-question-number="17" data-correct-answer="A">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">17</span>
                    <div class="flex-grow">
                        <p>a. This occasion, as a result, has made me more grateful to farmers and helped me understand what the saying “no pain, no gain” practically means.</p>
                        <p>b. It had, in fact, never occurred to me that farming would be so physically demanding.</p>
                        <p>c. I had to do the land ploughing, fertiliser spreading and grass uprooting in the burning summer heat.</p>
                        <p>d. Having hands-on experience on a farm for a fortnight really exhausted me, but at the same time made me more appreciative of farming.</p>
                        <p>e. Farming was such hard work that it made me sweat all the time and even lose a few kilos.</p>
                    </div>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement17" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. d – b – c – e – a</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement17" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. e – c – a – b – d</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement17" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. d – e – b – a – c</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement17" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. e – a – d – c – b</span>
                    </label>
                </div>
            </div>

            <div class="arrangement-question border-b border-gray-200 pb-4 pt-4" data-question-number="18" data-correct-answer="B">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">18</span>
                    <div class="flex-grow">
                        <p>Dear Mr Smith,</p>
                        <p>a. In case you have not received your chip-based card, contact our Customer Service at 0123247247.</p>
                        <p>b. This will automatically deactivate your magnetic stripe card, which can then be safely destroyed by your cutting it in half.</p>
                        <p>c. Your current magnetic stripe card expires on August 31st, whether the chip-based one is activated.</p>
                        <p>d. Should you have received the chip-based credit card, please use it instantly.</p>
                        <p>e. We would like to inform you that due to our operating system conversion, your magnetic stripe credit card has been replaced with a chip-based one, which has been on delivery to you.</p>
                        <p>Yours sincerely,</p>
                        <p>XYZ Bank</p>
                    </div>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement18" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. c – e – a – b – d</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement18" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. e – d – b – c – a</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement18" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. e – a – b – d – c</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="arrangement18" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. c – e – d – a – b</span>
                    </label>
                </div>
            </div>

            <!-- Section IV: Reading Comprehension 19-28 -->
            <h2 class="text-1xl sm:text-1xl font-bold text-gray-800 mt-8 mb-4">
                IV. Read the passage and mark the letter A, B, C or D on your answer sheet to indicate the best answer to each of the following questions from 19 to 28.
            </h2>
            <p class="text-base sm:text-lg text-gray-600 mb-4">
                We are living through a boom in greenwashing – the strategic use of comforting environmental claims to disguise business-as-usual pollution. Picture a chief executive whose company emits millions of tonnes of CO₂. Genuine decarbonisation would require bruising boardroom discussions, huge capital outlays, and a complete redesign of the firm’s model. Far easier is to hire a creative agency to plaster products with labels such as “carbon-neutral” or “net-zero,” calming critics, investors, and even eco-conscious children while emissions continue unsolved.
            </p>
            <p class="text-base sm:text-lg text-gray-600 mb-4">
                This tactic meets consumers at every turn. Airline websites promise guilt-free flights, petrol pumps boast zero-impact fuel, and even supermarket bacon is marketed as net-zero. <span id="insertionPointI">(I)</span> Advertising trickery is ancient, yet today’s greenwashing – the practice of deliberately covering ongoing pollution in eco-friendly language – has flourished only recently. The expression surfaced in the 1980s amid oil spills and growing climate science, but the real explosion has come as public anxiety over global heating and biodiversity loss has intensified. Faced with mounting scrutiny, many boards prefer glossy PR to structural reform. Such corporate sleight of hand has become so pervasive that regulators in Europe and the United States are scrambling to tighten rules on environmental claims, yet enforcement still lags behind marketing creativity. In the fossil-fuel sector exemplifies the issue. After decades covertly sowing doubt about climate science, oil and gas giants have grasped that direct denial is reputationally toxic. They have therefore swapped their denial tactics for a “green” paint-sprayer, trumpeting token investments in renewables while expanding drilling.
            </p>
            <p class="text-base sm:text-lg text-gray-600 mb-4">
                Why does this matter? Greenwashing and climate denial share a core objective: to postpone the emission cuts urgently required to avert climate breakdown <span id="insertionPointII">(II)</span> Whereas denial invites opposition, greenwashing lulls the public into believing problems are already solved. Under this collective illusion, pressure on high-emitting firms evaporates and the radical decisions needed to transform energy, transport, and food systems are delayed indefinitely. <span id="insertionPointIII">(III)</span> Greenwashing thus acts as a soothing lullaby, leading society toward ecological ruin with a tune of comforting half-truths. Exposing this deception is essential if clichés are to be replaced by real, measurable emission cuts. <span id="insertionPointIV">(IV)</span>
            </p>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="19" data-correct-answer="B">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">19</span>
                    <p class="flex-grow">According to paragraph 1, genuine decarbonisation ________.</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc19" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. involves hiring an expert agency</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc19" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. is costly and demanding</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc19" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. physically injures those involved</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc19" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. is overlooked by corporations</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="20" data-correct-answer="B">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">20</span>
                    <p class="flex-grow">Which of the following best summarises paragraph 1?</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc20" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. The great pressure to soothe environmental claims urges high-emitting corporations to adopt greenwashing wisely.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc20" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. Large-emission enterprises prefer “net-zero” or “carbon-neutral” tags on their offerings over genuine decarbonisation.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc20" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. Chief executives’ opinions are divided on whether or not genuine decarbonisation should be consistently implemented.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc20" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. The exponential growth of greenwashing is attributable to the environmental benefits the strategy brings to major emitters.</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="21" data-correct-answer="A">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">21</span>
                    <p class="flex-grow">Which of the following is NOT stated as an example of greenwashed products or services?</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc21" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. non-degradable electronics</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc21" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. zero-impact fuel</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc21" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. guilt-free flights</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc21" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. net-zero bacon</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="22" data-correct-answer="D">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">22</span>
                    <p class="flex-grow">The word glossy in paragraph 2 mostly means ________.</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc22" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. costly but ineffective</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc22" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. appealing but superficial</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc22" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. confusing but engaging</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc22" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. expensive but essential</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="23" data-correct-answer="B">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">23</span>
                    <p class="flex-grow">The word They in paragraph 2 refers to ________.</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc23" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. the United States</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc23" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. oil and gas giants</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc23" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. rules on environmental claims</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc23" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. regulators in Europe</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="24" data-correct-answer="D">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">24</span>
                    <p class="flex-grow">Which of the following best paraphrases the underlined sentence in paragraph 3?</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc24" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. Not until genuine efforts to cut down on emissions are recognised could the truth about greenwashing be concealed.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc24" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. No sooner had empty resolutions minimised emissions than the plain truth about greenwashing was elucidated.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc24" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. Were it not for genuine efforts to reduce emissions, rhetoric about greenwashing could not be brought to light.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc24" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. Genuine efforts to reduce emissions cannot take the place of rhetoric without greenwashing being uncovered.</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="25" data-correct-answer="C">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">25</span>
                    <p class="flex-grow">According to the passage, the adoption of “green” paint by fossil-fuel companies is mentioned as ________.</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc25" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. a prompt response to public demand for eco-friendly products</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc25" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. a particular way to dispute the claims about environmental crisis</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc25" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. a specific example of greenwashing</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc25" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. a typical application of climate science</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="26" data-correct-answer="A">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">26</span>
                    <p class="flex-grow">Which of the following can be inferred from the passage?</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc26" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. Increased public concern about environmental issues, coupled with their complacency with “eco-friendly” labelled products, contributes to the rise of greenwashing.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc26" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. Regulators have the necessary tools and resources to verify most environmental claims, which enables them to prevent misleading messages from reaching everyday consumers.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc26" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. The profits that high-emitting firms reap from running a “green” marketing campaign provide them with resources to reinvest in renewable ventures.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc26" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. The perceived action created by greenwashing has stressed the urgency for meaningful regulatory and corporate changes to address climate change.</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="27" data-correct-answer="D">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">27</span>
                    <p class="flex-grow">Where in the passage does the following sentence best fit?<br/>Yet greenwashing is arguably more insidious.</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc27" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. [I]</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc27" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. [IV]</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc27" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. [II]</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc27" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. [III]</span>
                    </label>
                </div>
            </div>

            <div class="multiple-choice-single-answer-question border-b border-gray-200 pb-4 pt-4" data-question-number="28" data-correct-answer="B">
                <div class="flex items-start gap-2 question-row">
                    <span class="font-semibold text-xl flex-shrink-0 w-8 text-right">28</span>
                    <p class="flex-grow">Which of the following best summarises the passage?</p>
                </div>
                <div class="flex flex-col space-y-2 mt-2 pl-10 options-row">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc28" value="A">
                        <span class="ml-2 text-base sm:text-lg">A. Major emitters have opted for open climate denials in preference to more sophisticated greenwashing to preserve profits and reputation instead of reforming their core operations.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc28" value="B">
                        <span class="ml-2 text-base sm:text-lg">B. A new wave of greenwashing allows corporations to hide ongoing pollution behind reassuring eco-labels, diverting scrutiny from the rapid emission cuts considered vital by scientists.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc28" value="C">
                        <span class="ml-2 text-base sm:text-lg">C. Greenwashing has now been pervading everyday products and services, raising customers’ awareness of the urgent need to maintain sustainable developments.</span>
                    </label>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="radio" class="form-radio text-blue-600" name="mc28" value="D">
                        <span class="ml-2 text-base sm:text-lg">D. Greenwashing has significantly grown in its scale and sophistication since its emergence, attracting considerable attention of both the general public and policymakers worldwide.</span>
                    </label>
                </div>
            </div>

            <!-- Section V: Cloze Test 29-34 -->
            <h2 class="text-1xl sm:text-1xl font-bold text-gray-800 mt-8 mb-4">
                V. Read the following announcement and mark the letter A, B, C or D on your answer sheet to indicate the option that best fits each of the numbered blanks from 29 to 34.
            </h2>
            <p class="cloze-passage-paragraph">
                Vietnam International Art Exhibition 2025 – A Landmark Cultural Event <br/>
                Taking place from July 25th to 29th at the International Centre for Exhibition in Hanoi, the Vietnam International Art Exhibition 2025 will showcase over 100 famous galleries
                <span class="cloze-text-blank">
                    <select id="clozeQuestion29" data-question-number="29" data-correct-answer="B" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                        <option value="">Choose...</option>
                        <option value="A">A. who</option>
                        <option value="B">B. which</option>
                        <option value="C">C. whom</option>
                        <option value="D">D. whose</option>
                    </select>
                </span> are derived from global art capitals alongside Vietnam’s
                <span class="cloze-text-blank">
                    <select id="clozeQuestion30" data-question-number="30" data-correct-answer="B" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                        <option value="">Choose...</option>
                        <option value="A">A. heading</option>
                        <option value="B">B. leading</option>
                        <option value="C">C. flying</option>
                        <option value="D">D. rating</option>
                    </select>
                </span> art institutions.
            </p>
            <p class="cloze-passage-paragraph">
                Visitors will gain exposure to a wide
                <span class="cloze-text-blank">
                    <select id="clozeQuestion31" data-question-number="31" data-correct-answer="A" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                        <option value="">Choose...</option>
                        <option value="A">A. range</option>
                        <option value="B">B. deal</option>
                        <option value="C">C. number</option>
                        <option value="D">D. amount</option>
                    </select>
                </span> of oil paintings, sculptures, digital art, and mixed media, blending traditional and contemporary styles. The event will also feature live art demonstrations and insightful discussions
                <span class="cloze-text-blank">
                    <select id="clozeQuestion32" data-question-number="32" data-correct-answer="D" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                        <option value="">Choose...</option>
                        <option value="A">A. have held</option>
                        <option value="B">B. be holding</option>
                        <option value="C">C. holding</option>
                        <option value="D">D. held</option>
                    </select>
                </span> by famous artists and curators, offering a deeper understanding of modern artistic trends.
            </p>
            <p class="cloze-passage-paragraph">
                This exhibition is a unique opportunity for
                <span class="cloze-text-blank">
                    <select id="clozeQuestion33" data-question-number="33" data-correct-answer="C" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                        <option value="">Choose...</option>
                        <option value="A">A. collectively</option>
                        <option value="B">B. collect</option>
                        <option value="C">C. collectors</option>
                        <option value="D">D. collective</option>
                    </select>
                </span> investors, and art enthusiasts to discover emerging talents and
                <span class="cloze-text-blank">
                    <select id="clozeQuestion34" data-question-number="34" data-correct-answer="C" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                        <option value="">Choose...</option>
                        <option value="A">A. fill up</option>
                        <option value="B">B. come up</option>
                        <option value="C">C. pick up</option>
                        <option value="D">D. get up</option>
                    </select>
                </span> some artworks. Don’t miss this incredible celebration of artistic expression!
            </p>

            <!-- Section VI: Cloze Test 35-40 -->
            <h2 class="text-1xl sm:text-1xl font-bold text-gray-800 mt-8 mb-4">
                VI. Read the following leaflet and mark the letter A, B, C or D on your answer sheet to indicate the option that best fits each of the numbered blanks from 35 to 40.
            </h2>
            <p class="cloze-passage-paragraph">
                How to Live Your Life Actively? <br/>
                If you are not naturally sporty, and finding ways to fit more activity into your daily life, here are several tips to help you make a routine
                <span class="cloze-text-blank">
                    <select id="clozeQuestion35" data-question-number="35" data-correct-answer="C" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                        <option value="">Choose...</option>
                        <option value="A">A. at</option>
                        <option value="B">B. to</option>
                        <option value="C">C. of</option>
                        <option value="D">D. in</option>
                    </select>
                </span> being active:
            </p>
            <ul class="list-disc list-inside space-y-2 text-gray-700 pl-4">
                <li>Select a realistic exercise plan.</li>
                <li>Track your progress using a health app
                    <span class="cloze-text-blank">
                        <select id="clozeQuestion36" data-question-number="36" data-correct-answer="D" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                            <option value="">Choose...</option>
                            <option value="A">A. nor</option>
                            <option value="B">B. but</option>
                            <option value="C">C. so</option>
                            <option value="D">D. or</option>
                        </select>
                    </span> a paper checklist.
                </li>
                <li>Take every opportunity to do such strength-building activities as carrying
                    <span class="cloze-text-blank">
                        <select id="clozeQuestion37" data-question-number="37" data-correct-answer="D" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                            <option value="">Choose...</option>
                            <option value="A">A. heavy bags grocery</option>
                            <option value="B">B. bags grocery heavy</option>
                            <option value="C">C. bags heavy grocery</option>
                            <option value="D">D. heavy grocery bags</option>
                        </select>
                    </span> and climbing the stairs.
                </li>
                <li>Invite friends and
                    <span class="cloze-text-blank">
                        <select id="clozeQuestion38" data-question-number="38" data-correct-answer="D" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                            <option value="">Choose...</option>
                            <option value="A">A. another</option>
                            <option value="B">B. others</option>
                            <option value="C">C. the others</option>
                            <option value="D">D. other</option>
                        </select>
                    </span> family members to join in, and try
                    <span class="cloze-text-blank">
                        <select id="clozeQuestion39" data-question-number="39" data-correct-answer="C" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                            <option value="">Choose...</option>
                            <option value="A">A. replacing</option>
                            <option value="B">B. contrasting</option>
                            <option value="C">C. engaging</option>
                            <option value="D">D. comparing</option>
                        </select>
                    </span> everyone’s competitive side with challenges like seeing who can do the most steps or cover the most distance in a day.
                </li>
                <li>Reward yourself with a treat like a favourite TV show if your plan works
                    <span class="cloze-text-blank">
                        <select id="clozeQuestion40" data-question-number="40" data-correct-answer="D" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200">
                            <option value="">Choose...</option>
                            <option value="A">A. values</option>
                            <option value="B">B. legends</option>
                            <option value="C">C. marvels</option>
                            <option value="D">D. wonders</option>
                        </select>
                    </span> to maintain your motivation.
                </li>
            </ul>
        </div>

        <div class="mt-8 flex flex-col sm:flex-row justify-center gap-4">
            <button id="checkAnswersBtn"
                    class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50"
                    disabled>
                Check Answers
            </button>
            <button id="saveResultsBtn"
                    class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50"
                    disabled>
                Download Results (PDF)
            </button>
        </div>

        <div id="feedback" class="mt-6 text-center text-lg font-semibold text-gray-800"></div>

    </div>

    <!-- Floating Highlight Toolbar -->
    <div id="floatingToolbar" class="absolute hidden bg-gray-800 p-2 rounded-lg shadow-xl flex items-center space-x-2 z-50">
        <button id="toolbarClearBtn" title="Clear Highlight" class="p-1 rounded-full bg-gray-600 hover:bg-gray-700 text-white text-lg leading-none flex items-center justify-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 11-2 0v6a1 1 0 112 0V8z" clip-rule="evenodd" />
            </svg>
        </button>
        <div id="toolbarYellow" title="Highlight Yellow" class="w-6 h-6 rounded-full cursor-pointer bg-yellow-400 hover:bg-yellow-500 transition-colors duration-200" data-color="highlight-yellow"></div>
        <div id="toolbarBlue" title="Highlight Blue" class="w-6 h-6 rounded-full cursor-pointer bg-blue-400 hover:bg-blue-500 transition-colors duration-200" data-color="highlight-blue"></div>
        <div id="toolbarGreen" title="Highlight Green" class="w-6 h-6 rounded-full cursor-pointer bg-green-400 hover:bg-green-500 transition-colors duration-200" data-color="highlight-green"></div>
        <div id="toolbarPink" title="Highlight Pink" class="w-6 h-6 rounded-full cursor-pointer bg-pink-400 hover:bg-pink-500 transition-colors duration-200" data-color="highlight-pink"></div>
    </div>

    <!-- jsPDF Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Select all relevant question types
            const clozeQuestions = document.querySelectorAll('select[id^="clozeQuestion"]');
            const multipleChoiceSingleAnswerQuestions = document.querySelectorAll('.multiple-choice-single-answer-question');
            const arrangementQuestions = document.querySelectorAll('.arrangement-question');

            const checkAnswersBtn = document.getElementById('checkAnswersBtn');
            const saveResultsBtn = document.getElementById('saveResultsBtn');
            const feedbackDiv = document.getElementById('feedback');
            const dictationContent = document.getElementById('dictationContent');

            // Floating toolbar elements
            const floatingToolbar = document.getElementById('floatingToolbar');
            const toolbarClearBtn = document.getElementById('toolbarClearBtn');
            const toolbarYellow = document.getElementById('toolbarYellow');
            const toolbarBlue = document.getElementById('toolbarBlue');
            const toolbarGreen = document.getElementById('toolbarGreen');
            const toolbarPink = document.getElementById('toolbarPink');

            let currentHighlights = []; // Stores highlight data: { text: "...", color: "..." }
            let lastSelectionRange = null; // Stores the last text selection range
            let answersCheckedFlag = false; // Flag to track if answers have been checked

            // --- Highlighting Logic ---
            function applyHighlight(colorClass) {
                const selection = window.getSelection();
                let range;

                if (selection.rangeCount > 0 && !selection.isCollapsed) {
                    range = selection.getRangeAt(0);
                } else if (lastSelectionRange) {
                    range = lastSelectionRange;
                    selection.removeAllRanges();
                    selection.addRange(range);
                } else {
                    feedbackDiv.textContent = "No text selected or previously selected to highlight.";
                    feedbackDiv.classList.add('text-red-600');
                    return;
                }

                const selectedText = range.toString().trim();
                if (!selectedText) return;

                const span = document.createElement('span');
                span.classList.add(colorClass);
                span.classList.add('highlighted-text');

                try {
                    const contents = range.extractContents();
                    span.appendChild(contents);
                    range.insertNode(span);

                    const existingHighlight = currentHighlights.find(
                        h => h.text === selectedText && h.color === colorClass.replace('highlight-', '')
                    );
                    if (!existingHighlight) {
                        currentHighlights.push({
                            text: selectedText,
                            color: colorClass.replace('highlight-', '')
                        });
                    }

                    selection.removeAllRanges();
                    floatingToolbar.classList.add('hidden');
                    lastSelectionRange = null;
                } catch (e) {
                    console.error("Error applying highlight:", e);
                    feedbackDiv.textContent = "Could not highlight complex selection. Try selecting less text.";
                    feedbackDiv.classList.add('text-red-600');
                }
            }

            function clearSelectedHighlight() {
                const selection = window.getSelection();
                let range;

                if (selection.rangeCount > 0 && !selection.isCollapsed) {
                    range = selection.getRangeAt(0);
                } else if (lastSelectionRange) {
                    range = lastSelectionRange;
                    selection.removeAllRanges();
                    selection.addRange(range);
                } else {
                    feedbackDiv.textContent = "No text selected or previously selected to clear highlight.";
                    feedbackDiv.classList.add('text-red-600');
                    return;
                }

                const selectedNode = range.commonAncestorContainer;
                let highlightedSpan = null;

                if (selectedNode && selectedNode.nodeType === Node.ELEMENT_NODE && selectedNode.classList.contains('highlighted-text')) {
                    highlightedSpan = selectedNode;
                } else {
                    let currentNode = selectedNode;
                    while (currentNode && currentNode !== dictationContent && currentNode.parentNode) {
                        if (currentNode.nodeType === Node.ELEMENT_NODE && currentNode.classList.contains('highlighted-text')) {
                            highlightedSpan = currentNode;
                            break;
                        }
                        currentNode = currentNode.parentNode;
                    }
                }

                if (highlightedSpan && highlightedSpan.parentNode) {
                    const textContent = highlightedSpan.textContent;
                    highlightedSpan.parentNode.replaceChild(document.createTextNode(textContent), highlightedSpan);

                    currentHighlights = currentHighlights.filter(h => h.text.toLowerCase() !== textContent.toLowerCase());

                    selection.removeAllRanges();
                    floatingToolbar.classList.add('hidden');
                    lastSelectionRange = null;
                    feedbackDiv.textContent = "Highlight cleared.";
                    feedbackDiv.classList.remove('text-green-600', 'text-red-600', 'text-blue-600');
                } else {
                    feedbackDiv.textContent = "No highlight found to clear for this selection.";
                    feedbackDiv.classList.add('text-red-600');
                }
            }

            // --- Event Listeners for Toolbar ---
            toolbarYellow.addEventListener('click', () => applyHighlight('highlight-yellow'));
            toolbarBlue.addEventListener('click', () => applyHighlight('highlight-blue'));
            toolbarGreen.addEventListener('click', () => applyHighlight('highlight-green'));
            toolbarPink.addEventListener('click', () => applyHighlight('highlight-pink'));
            toolbarClearBtn.addEventListener('click', clearSelectedHighlight);

            dictationContent.addEventListener('mouseup', (event) => {
                const selection = window.getSelection();
                if (selection.rangeCount > 0 && !selection.isCollapsed) {
                    lastSelectionRange = selection.getRangeAt(0);
                    const rect = lastSelectionRange.getBoundingClientRect();
                    const toolbarHeight = floatingToolbar.offsetHeight;
                    const toolbarWidth = floatingToolbar.offsetWidth;

                    floatingToolbar.style.top = `${rect.top + window.scrollY - toolbarHeight - 10}px`;
                    let leftPos = rect.left + window.scrollX + (rect.width / 2) - (toolbarWidth / 2);
                    leftPos = Math.max(10, leftPos);
                    leftPos = Math.min(leftPos, window.innerWidth - toolbarWidth - 10);
                    floatingToolbar.style.left = `${leftPos}px`;

                    floatingToolbar.classList.remove('hidden');
                } else {
                    floatingToolbar.classList.add('hidden');
                    lastSelectionRange = null;
                }
            });

            document.addEventListener('mousedown', (event) => {
                if (!floatingToolbar.contains(event.target) && !dictationContent.contains(event.target)) {
                    floatingToolbar.classList.add('hidden');
                    lastSelectionRange = null;
                }
            });

            // --- Worksheet Functionality ---
            function getResults() {
                const results = [];
                let correctCount = 0;
                let totalQuestions = 0;

                // Process Cloze Questions (Sections I, V, VI)
                clozeQuestions.forEach(selectElement => {
                    totalQuestions++;
                    const questionNumber = selectElement.dataset.questionNumber;
                    const correctAnswer = selectElement.dataset.correctAnswer.toLowerCase();
                    const userAnswer = selectElement.value.toLowerCase();
                    const questionText = `Blank ${questionNumber}`;

                    let isCorrect = (userAnswer === correctAnswer);
                    if (isCorrect) {
                        correctCount++;
                    }
                    // For display in PDF, get the full option text
                    const selectedOptionText = selectElement.options[selectElement.selectedIndex].text;
                    const correctOptionText = Array.from(selectElement.options).find(opt => opt.value.toLowerCase() === correctAnswer)?.text || selectElement.dataset.correctAnswer;

                    results.push({
                        type: 'CLOZE_BLANK',
                        questionNumber: parseInt(questionNumber),
                        statement: questionText,
                        userAnswer: selectedOptionText,
                        correctAnswer: correctOptionText,
                        isCorrect: isCorrect
                    });
                });
                
                // Process Multiple Choice (single answer) Questions
                multipleChoiceSingleAnswerQuestions.forEach(qDiv => {
                    totalQuestions++;
                    const questionNumber = qDiv.dataset.questionNumber;
                    const correctAnswer = qDiv.dataset.correctAnswer.toLowerCase();
                    const selectedRadio = qDiv.querySelector(`input[name="mc${questionNumber}"]:checked`);
                    const userAnswer = selectedRadio ? selectedRadio.value.toLowerCase() : "No answer";
                    const statement = qDiv.querySelector('p').textContent.trim();

                    let isCorrect = (userAnswer === correctAnswer);
                    if (isCorrect) {
                        correctCount++;
                    }
                    results.push({
                        type: 'MULTIPLE_CHOICE_SINGLE',
                        questionNumber: parseInt(questionNumber),
                        statement: statement,
                        userAnswer: selectedRadio ? selectedRadio.value : "No answer", // Store just A/B/C/D
                        correctAnswer: qDiv.dataset.correctAnswer,
                        isCorrect: isCorrect
                    });
                });

                // Process Arrangement Questions
                arrangementQuestions.forEach(qDiv => {
                    totalQuestions++;
                    const questionNumber = qDiv.dataset.questionNumber;
                    const correctAnswer = qDiv.dataset.correctAnswer.toLowerCase();
                    const selectedRadio = qDiv.querySelector(`input[name="arrangement${questionNumber}"]:checked`);
                    const userAnswer = selectedRadio ? selectedRadio.value.toLowerCase() : "No answer";
                    const statement = `Arrangement Question ${questionNumber}`; // Simpler statement for PDF

                    let isCorrect = (userAnswer === correctAnswer);
                    if (isCorrect) {
                        correctCount++;
                    }
                    results.push({
                        type: 'ARRANGEMENT',
                        questionNumber: parseInt(questionNumber),
                        statement: statement,
                        userAnswer: selectedRadio ? selectedRadio.value : "No answer",
                        correctAnswer: qDiv.dataset.correctAnswer,
                        isCorrect: isCorrect
                    });
                });

                return { results, correctCount, totalQuestions };
            }

            // Function to check if all questions have an answer
            function areAllQuestionsAnswered() {
                let allAnswered = true;

                clozeQuestions.forEach(selectElement => {
                    if (selectElement.value === "") {
                        allAnswered = false;
                    }
                });

                multipleChoiceSingleAnswerQuestions.forEach(qDiv => {
                    const selectedRadio = qDiv.querySelector(`input[name="mc${qDiv.dataset.questionNumber}"]:checked`);
                    if (!selectedRadio) {
                        allAnswered = false;
                    }
                });

                arrangementQuestions.forEach(qDiv => {
                    const selectedRadio = qDiv.querySelector(`input[name="arrangement${qDiv.dataset.questionNumber}"]:checked`);
                    if (!selectedRadio) {
                        allAnswered = false;
                    }
                });
                
                return allAnswered;
            }

            // Function to update button states based on completion and answers checked
            function updateButtonStates() {
                if (areAllQuestionsAnswered()) {
                    checkAnswersBtn.disabled = false;
                    checkAnswersBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                } else {
                    checkAnswersBtn.disabled = true;
                    checkAnswersBtn.classList.add('opacity-50', 'cursor-not-allowed');
                }

                if (answersCheckedFlag) {
                    saveResultsBtn.disabled = false;
                    saveResultsBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                } else {
                    saveResultsBtn.disabled = true;
                    saveResultsBtn.classList.add('opacity-50', 'cursor-not-allowed');
                }
            }

            // Function to lock answers after checking
            function lockAnswers() {
                clozeQuestions.forEach(selectElement => {
                    selectElement.disabled = true;
                });
                multipleChoiceSingleAnswerQuestions.forEach(qDiv => {
                    qDiv.querySelectorAll('input[type="radio"]').forEach(radio => {
                        radio.disabled = true;
                    });
                });
                arrangementQuestions.forEach(qDiv => {
                    qDiv.querySelectorAll('input[type="radio"]').forEach(radio => {
                        radio.disabled = true;
                    });
                });
            }

            // Initial state for buttons
            updateButtonStates();

            checkAnswersBtn.addEventListener('click', () => {
                getResults();
                lockAnswers();
                answersCheckedFlag = true;
                updateButtonStates();
                feedbackDiv.textContent = "Answers checked! Download your PDF for results.";
                feedbackDiv.classList.remove('text-green-600', 'text-red-600', 'text-blue-600');
            });

            saveResultsBtn.addEventListener('click', () => {
                const { results: allResults, correctCount, totalQuestions } = getResults();

                feedbackDiv.textContent = "Generating PDF...";
                feedbackDiv.classList.remove('text-green-600', 'text-red-600');
                feedbackDiv.classList.add('text-blue-600');

                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();

                    doc.setFontSize(22);
                    doc.text("Reading Passage: Your Results", 105, 20, null, null, "center");

                    doc.setFontSize(14);
                    doc.text(`Report generated on: ${new Date().toLocaleString()}`, 10, 30);
                    doc.text(`Total Score: ${correctCount} out of ${totalQuestions} correct!`, 10, 40);

                    // Answers Table
                    doc.setFontSize(16);
                    doc.text("Your Answers", 10, 60);

                    allResults.sort((a, b) => {
                        const numA = parseInt(a.questionNumber.toString().split('-')[0]);
                        const numB = parseInt(b.questionNumber.toString().split('-')[0]);
                        return numA - numB;
                    });


                    const tableColumn = ["Question #", "Type", "Your Answer", "Correct Answer", "Status"];
                    const tableRows = [];

                    allResults.forEach(result => {
                        const status = result.isCorrect ? "Correct" : "Incorrect";
                        tableRows.push([
                            result.questionNumber.toString(),
                            result.type,
                            result.userAnswer || "No answer",
                            result.correctAnswer,
                            status
                        ]);
                    });

                    doc.autoTable({
                        head: [tableColumn],
                        body: tableRows,
                        startY: 65,
                        theme: 'striped',
                        styles: {
                            fontSize: 10,
                            cellPadding: 2,
                            fillColor: [255, 255, 255],
                            textColor: [51, 51, 51],
                            lineColor: [200, 200, 200],
                            lineWidth: 0.1,
                            overflow: 'linebreak',
                        },
                        headStyles: {
                            fillColor: [220, 230, 240],
                            textColor: [0, 0, 0],
                            fontStyle: 'bold'
                        },
                        columnStyles: {
                            0: { cellWidth: 20 },
                            1: { cellWidth: 30 },
                            2: { cellWidth: 55 },
                            3: { cellWidth: 55 },
                            4: { cellWidth: 30, halign: 'center' }
                        },
                        didDrawCell: (data) => {
                            if (data.section === 'body' && data.column.index === 4) { // Status column
                                const status = data.cell.text[0];
                                if (status === 'Correct') {
                                    doc.setFillColor(144, 238, 144);
                                } else {
                                    doc.setFillColor(255, 182, 193);
                                }
                                doc.rect(data.cell.x + data.cell.padding('left'), data.cell.y + data.cell.padding('top'), data.cell.width - data.cell.padding('left') - data.cell.padding('right'), data.cell.height - data.cell.padding('top') - data.cell.padding('bottom'), 'F');
                                doc.setTextColor(0, 0, 0);
                                doc.text(status, data.cell.x + data.cell.width / 2, data.cell.y + data.cell.height / 2, { align: 'center', baseline: 'middle' });
                            }
                        }
                    });

                    let finalY = doc.lastAutoTable.finalY + 15;
                    doc.setFontSize(16);
                    doc.text("Your Highlights", 10, finalY);
                    finalY += 10;

                    if (currentHighlights.length > 0) {
                        doc.setFontSize(12);
                        currentHighlights.forEach((h) => {
                            const textLines = doc.splitTextToSize(`- "${h.text}" (Color: ${h.color})`, doc.internal.pageSize.width - 25);
                            doc.text(textLines, 15, finalY);
                            finalY += (textLines.length * 7);
                        });
                    } else {
                        doc.setFontSize(12);
                        doc.setTextColor(150, 150, 150);
                        doc.text("No highlights were made.", 15, finalY);
                    }

                    const filename = `reading_passage_results_${new Date().toISOString().slice(0,10)}.pdf`;
                    doc.save(filename);

                    feedbackDiv.textContent = "Results PDF generated and downloaded!";
                    feedbackDiv.classList.remove('text-blue-600');
                    feedbackDiv.classList.add('text-green-600');

                } catch (error) {
                    feedbackDiv.textContent = `An error occurred during PDF generation: ${error.message}`;
                    feedbackDiv.classList.remove('text-blue-600');
                    feedbackDiv.classList.add('text-red-600');
                    console.error('Error generating PDF:', error);
                }
            });

            // Event listeners to update button states when input changes
            clozeQuestions.forEach(selectElement => {
                selectElement.addEventListener('change', () => {
                    feedbackDiv.textContent = '';
                    answersCheckedFlag = false;
                    updateButtonStates();
                });
            });

            multipleChoiceSingleAnswerQuestions.forEach(qDiv => {
                qDiv.querySelectorAll('input[type="radio"]').forEach(radio => {
                    radio.addEventListener('change', () => {
                        feedbackDiv.textContent = '';
                        answersCheckedFlag = false;
                        updateButtonStates();
                    });
                });
            });

            arrangementQuestions.forEach(qDiv => {
                qDiv.querySelectorAll('input[type="radio"]').forEach(radio => {
                    radio.addEventListener('change', () => {
                        feedbackDiv.textContent = '';
                        answersCheckedFlag = false;
                        updateButtonStates();
                    });
                });
            });
        });
    </script>
</body>
</html>
