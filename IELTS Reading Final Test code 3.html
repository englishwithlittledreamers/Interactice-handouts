<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Reading Test - Code 3</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- jsPDF library for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- jsPDF AutoTable plugin for table generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <style>
        /* Custom styles for better readability and aesthetics */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
            color: #333;
            overflow: hidden; /* Prevent body scroll */
        }
        .main-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        .content-wrapper {
            display: flex;
            flex-direction: row;
            flex-grow: 1;
            overflow: hidden;
        }
        .passage-half, .questions-half {
            width: 50%;
            overflow-y: auto;
            padding: 1.5rem;
        }
        .passage-half {
            border-right: 2px solid #e5e7eb;
        }

        @media (max-width: 1024px) {
            .content-wrapper {
                flex-direction: column;
            }
            .passage-half, .questions-half {
                width: 100%;
                height: 50%;
                border-right: none;
            }
            .passage-half {
                border-bottom: 2px solid #e5e7eb;
            }
        }

        .question-group {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
        }
        .question-group:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        /* Input styles for different question types */
        .tfng-btn-group .btn {
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            background-color: #f9fafb;
        }
        .tfng-btn-group .btn.selected {
            background-color: #4f46e5;
            color: white;
            border-color: #4f46e5;
        }
        .short-answer-input {
            width: 100%;
            max-width: 250px;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            transition: border-color 0.2s;
        }
        .short-answer-input:focus {
            outline: none;
            border-color: #4f46e5;
        }
        .dropdown-select {
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background-color: white;
        }

        /* Tab specific styles */
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            flex-shrink: 0;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            border: 1px solid #e5e7eb;
            background-color: #e2e8f0;
            color: #4a5568;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border-radius: 0.5rem;
            margin: 0 0.25rem;
        }
        .tab-button.active {
            background-color: #4f46e5;
            color: white;
            border-color: #4f46e5;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; height: 100%; }
        
        /* Highlight styles */
        .highlight-toolbar {
            position: absolute;
            background-color: #1f2937;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
        }
        .highlight-toolbar button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 5px;
        }
        mark {
            background-color: #fef08a;
            padding: 0.1em 0.2em;
            border-radius: 0.2em;
        }
        .frozen-form {
            pointer-events: none;
            opacity: 0.7;
        }
        .timer-container {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            padding: 0.5rem;
            background-color: #e0f2fe;
            color: #0c4a6e;
            border-bottom: 1px solid #e5e7eb;
            flex-shrink: 0;
        }
        .timer-container.ended {
            background-color: #fecaca;
            color: #991b1b;
        }
    </style>
</head>
<body class="p-0 sm:p-0 md:p-0">

    <!-- Highlight Toolbar -->
    <div id="highlight-toolbar" class="highlight-toolbar">
        <button id="highlight-btn">Highlight</button>
    </div>

    <div class="max-w-full mx-auto bg-white rounded-xl shadow-lg main-container">
        <div class="p-4 border-b">
            <h1 class="text-2xl md:text-3xl font-extrabold text-center text-indigo-700">IELTS Reading Test - Code 3</h1>
        </div>
        
        <!-- Timer Display -->
        <div id="timer-container" class="timer-container">
            Time Remaining: <span id="countdown">60:00</span>
        </div>

        <!-- Tab Buttons -->
        <div class="tabs p-4">
            <button class="tab-button active" onclick="openTab(event, 'passage1')">Passage 1</button>
            <button class="tab-button" onclick="openTab(event, 'passage2')">Passage 2</button>
            <button class="tab-button" onclick="openTab(event, 'passage3')">Passage 3</button>
        </div>

        <div class="content-wrapper">
            <!-- Passage Half (Left) -->
            <div class="passage-half">
                <!-- Passage 1 Text -->
                <div id="passage1-text" class="tab-content active">
                    <h3 class="text-xl font-bold text-indigo-600 mb-4">Henry Moore (1898-1986)</h3>
                    <div class="text-gray-700 leading-relaxed space-y-4 selectable-text">
                        <p>Henry Moore was born in Castleford, a small town near Leeds in the north of England. He was the seventh child of Raymond Moore and his wife Mary Baker. He studied at Castleford Grammar School from 1909 to 1915, where his early interest in art was encouraged by his teacher Alice Gostick. After leaving school, Moore hoped to become a sculptor, but instead he complied with his father’s wish that he train as a schoolteacher. He had to abandon his training in 1917 when he was sent to France to fight in the First World War.</p>
                        <p>After the war, Moore enrolled at the Leeds School of Art, where he studied for two years. In his first year, he spent most of his time drawing. Although he wanted to study sculpture, no teacher was appointed until his second year. At the end of that year, he passed the sculpture examination and was awarded a scholarship to the Royal College of Art in London. In September 1921, he moved to London and began three years of advanced study in sculpture.</p>
                        <p>Alongside the instruction he received at the Royal College, Moore visited many of the London museums, particularly the British Museum, which had a wide-ranging collection of ancient sculpture. During these visits, he discovered the power and beauty of ancient Egyptian and African sculpture. As he became increasingly interested in these ‘primitive’ forms of art, he turned away from European sculptural traditions.</p>
                        <p>After graduating, Moore spent the first six months of 1925 travelling in France. When he visited the Trocadero Museum in Paris, he was impressed by a cast of a Mayan* sculpture of the rain spirit. It was a male reclining figure with its knees drawn up together, and its head at a right angle to its body. Moore became fascinated with this stone sculpture, which he thought had a power and originality that no other stone sculpture possessed. He himself started carving a variety of subjects in stone, including depiction of reclining women, mother-and-child groups, and masks.</p>
                        <p>Moore’s exceptional talent soon gained recognition, and in 1926 he started work as a sculpture instructor at the Royal College. In 1933, he became a member of a group of young artists called Unit One. The aim of the group was to convince the English public of the merits of the emerging international movement in modern art and architecture.</p>
                        <p>Around this time, Moore moved away from the human figure to experiment with abstract shapes. In 1931, he held an exhibition at the Leicester Galleries in London. His work was enthusiastically welcomed by fellow sculptors, but the reviews in the press were extremely negative and turned Moore into a notorious figure. There were calls for his resignation from the Royal College, and the following year, when his contract expired, he left to start a sculpture department at the Chelsea School of Art in London.</p>
                        <p>Throughout the 1930s, Moore did not show any inclination to please the British public. He became interested in the paintings of the Spanish artist Pablo Picasso, whose work inspired him to distort the human body in a radical way. At times, he seemed to abandon the human figure altogether. The pages of his sketchbooks from this period show his ideas for abstract sculptures that bore little resemblance to the human form.</p>
                        <p>In 1940, during the Second World War, Moore stopped teaching at the Chelsea School and moved to a farmhouse about 20 miles north of London. A shortage of materials forced him to focus on drawing. He did numerous small sketches of Londoners, later turning these ideas into large coloured drawings in his studio. In 1942, he returned to Castleford to make a series of sketches of the miners who worked there.</p>
                        <p>In 1944, Harlow, a town near London, offered Moore a commission for a sculpture depicting a family. The resulting work signifies a dramatic change in Moore’s style, away from the experimentation of the 1930s towards a more natural and humanistic subject matter. He did dozens of studies in clay for the sculpture, and these were cast in bronze and issued in editions of seven to nine copies each. In this way, Moore’s work became available to collectors all over the world. The boost to his income enabled him to take on ambitious projects and start working on the scale he felt his sculpture demanded.</p>
                        <p>Critics who had begun to think that Moore had become less revolutionary were proven wrong by the appearance, in 1950, of the first of Moore’s series of standing figures in bronze, with their harsh and angular pierced forms and distinct impression of menace. Moore also varied his subject matter in the 1950s with such works as Warrior with Shield and Falling Warrior. These were rare examples of Moore’s use of the male figure and owe something to his visit to Greece in 1951, when he had the opportunity to study ancient works of art.</p>
                        <p>In his final years, Moore created the Henry Moore Foundation to promote art appreciation and to display his work. Moore was the first modern English sculptor to achieve international critical acclaim and he is still regarded as one of the most important sculptors of the 20th century.</p>
                        <p class="text-sm italic">*Mayan: belonging to an ancient civilisation that inhabited parts of current-day Mexico, Guatemala, Belize, El Salvador and Honduras.</p>
                    </div>
                </div>
                 <!-- Passage 2 Text -->
                <div id="passage2-text" class="tab-content">
                     <h3 class="text-xl font-bold text-indigo-600 mb-4">The Desolenator: producing clean water</h3>
                    <div class="text-gray-700 leading-relaxed space-y-4 selectable-text">
                        <p><b>A</b> Travelling around Thailand in the 1990s, William Janssen was impressed with the basic rooftop solar heating systems that were on many homes, where energy from the sun was absorbed by a plate and then used to heat water for domestic use. Two decades later Janssen developed that basic idea he saw in Southeast Asia into a portable device that uses the power from the sun to purify water.</p>
                        <p><b>B</b> The Desolenator operates as a mobile desalination unit that can take water from different places, such as the sea, rivers, boreholes and rain, and purify it for human consumption. It is particularly valuable in regions where natural groundwater reserves have been polluted, or where seawater is the only water source available. Janssen saw that there was a need for a sustainable way to clean water is both the developing and the developed countries when he moved to the United Arab Emirates and saw large-scale water processing. ‘I was confronted with the enormous carbon footprint that the Gulf nations have because of all of the desalination that they do,’ he says.</p>
                        <p><b>C</b> The Desolenator can produce 15 litres of drinking water per day, enough to sustain a family for cooking and drinking. Its main selling point is that unlike standard desalination techniques, it doesn’t require a generated power supply: just sunlight. It measures 120 cm by 90 cm, and it easy to transport, thanks to its two wheels. Water enters through a pipe, and flows as a thin film between a sheet of double glazing and the surface of a solar panel, where it is heated by the sun. the warm water flows into a small boiler (heated by a solar-powered battery) where it is converted to steam. When the steam cools, it becomes distilled water. The device has a very simple filter to trap particles, and this can easily be shaken to remove them. There are two tubes for liquid coming out: one for the waste – salt from seawater, fluoride, etc. – and another for the distilled water. The performance of the unit is shown on an LCD screen and transmitted to the company which provides servicing when necessary.</p>
                        <p><b>D</b> A recent analysis found that at least two-thirds of the world’s population lives with severe water scarcity for at least a month every year. Janssen says that be 2030 half of the world’s population will be living with water stress – where the demand exceeds the supply over a certain period of time. ‘It is really important that a sustainable solution is brought to the market that is able to help these people,’ he says. Many countries ‘don’t have the money for desalination plants, which are very expensive to build. They don’t have the money to operate them, they are very maintenance intensive, and they don’t have the money to buy the diesel to run the desalination plants, so it is a really bad situation.’</p>
                        <p><b>E</b> The device is aimed at a wide variety of users – from homeowners in the developing world who do not have a constant supply of water to people living off the grid in rural parts of the US. The first commercial versions of the Desolenator are expected to be in operation in India early next year, after field tests are carried out. The market for the self-sufficient devices in developing countries is twofold – those who cannot afford the money for the device outright and pay through microfinance, and middle-income homes that can lease their own equipment. ‘People in India don’t pay for a fridge outright; they pay for it over six months. They would put the Desolenator on their roof and hook it up to their municipal supply and they would get very reliable drinking water on a daily basis,’ Janssen says. In the developed world, it is aimed at niche markets where tap water is unavailable – for camping, on boats, or for the military, for instance.</p>
                        <p><b>F</b> Prices will vary according to where it is bought. In the developing world, the price will depend on what deal aid organisations can negotiate. In developed countries, it is likely to come in at $1,000 (£685) a unit, said Janssen. ‘We are a venture with a social mission. We are aware that the product we have envisioned is mainly finding application in the developing world and humanitarian sector and that this is the way we will proceed. We do realise, though, that to be a viable company there is a bottom line to keep in mind,’ he says.</p>
                        <p><b>G</b> The company itself is based at Imperial College London, although Janssen, its chief executive, still lives in the UAE. It has raised £340,000 in funding so far. Within two years, he says, the company aims to be selling 1,000 units a month, mainly in the humanitarian field. They are expected to be sold in areas such as Australia, northern Chile, Peru, Texas and California.</p>
                    </div>
                </div>
                 <!-- Passage 3 Text -->
                <div id="passage3-text" class="tab-content">
                    <h3 class="text-xl font-bold text-indigo-600 mb-4">Why fairy tales are really scary tales</h3>
                    <div class="text-gray-700 leading-relaxed space-y-4 selectable-text">
                         <p>People of every culture tell each other fairy tales but the same story often takes a variety of forms in different parts of the world. In the story of Little Red Riding Hood that European children are familiar with, a young girl on the way to see her grandmother meets a wolf and tells him where she is going. The wolf runs on ahead and disposes of the grandmother, then gets into bed dressed in the grandmother’s clothes to wait for Little Red Riding Hood. You may think you know the story – but which version? In some versions, the wolf swallows up the grandmother, while in others it locks her in a cupboard. In some stories Red Riding Hood gets the better of the wolf on her own, while in others a hunter or a woodcutter hears her cries and comes to her rescue.</p>
                        <p>The universal appeal of these tales is frequently attributed to the idea that they contain cautionary messages: in the case of Little Red Riding Hood, to listen to your mother, and avoid talking to strangers. ‘It might be what we find interesting about this story is that it’s got this survival-relevant information in it,’ says anthropologist Jamie Tehrani at Durham University in the UK. But his research suggests otherwise. ‘We have this huge gap in our knowledge about the history and prehistory of storytelling, despite the fact that we know this genre is an incredibly ancient one,’ he says. That hasn’t stopped anthropologists, folklorists* and other academics devising theories to explain the importance of fairy tales in human society. Now Tehrani has found a way to test these ideas, borrowing a technique from evolutionary biologists.</p>
                        <p>To work out the evolutionary history, development and relationships among groups of organisms, biologists compare the characteristics of living species in a process called ‘phylogenetic analysis’. Tehrani has used the same approach to compare related versions of fairy tales to discover how they have evolved and which elements have survived longest.</p>
                        <p>Tehrani’s analysis focused on Little Red Riding Hood in its many forms, which include another Western fairy tale known as The Wolf and the Kids. Checking for variants of these two tales and similar stories from Africa, East Asia and other regions, he ended up with 58 stories recorded from oral traditions. Once his phylogenetic analysis had established that they were indeed related, he used the same methods to explore how they have developed and altered over time.</p>
                        <p>First he tested some assumptions about which aspects of the story alter least as it evolves, indicating their importance. Folklorists believe that what happens in a story is more central to the story than the characters in it – that visiting a relative, only to be met by a scary animal in disguise, is more fundamental than whether the visitor is a little girl or three siblings, or the animal is a tiger instead of a wolf.</p>
                        <p>However, Tehrani found no significant difference in the rate of evolution of incidents compared with that of characters. ‘Certain episodes are very stable because they are crucial to the story, but there are lots of other details that can evolve quite freely,’ he says. Neither did his analysis support the theory that the central section of a story is the most conserved part. He found no significant difference in the flexibility of events there compared with the beginning or the end.</p>
                        <p>But the really big surprise came when he looked at the cautionary elements of the story. ‘Studies on hunter-gatherer folk tales suggest that these narratives include really important information about the environment and the possible dangers that may be faced there – stuff that’s relevant to survival,’ he says. Yet in his analysis such elements were just as flexible as seemingly trivial details. What, then, is important enough to be reproduced from generation to generation?</p>
                        <p>The answer, it would appear, is fear – blood-thirsty and gruesome aspects of the story, such as the eating of the grandmother by the wolf, turned out to be the best preserved of all. Why are these details retained by generations of storytellers, when other features are not? Tehrani has an idea: ‘In an oral context, a story won’t survive because of one great teller. It also needs to be interesting when it’s told by someone who’s not necessarily a great storyteller.’ Maybe being swallowed whole by a wolf, then cut out of its stomach alive is so gripping that it helps the story remain popular, no matter how badly it’s told.</p>
                        <p>Jack Zipes at the University of Minnesota, Minneapolis, is unconvinced by Tehrani’s views on fairy tales. ‘Even if they’re gruesome, they won’t stick unless they matter,’ he says. He believes the perennial theme of women as victims in stories like Little Red Riding Hood explains why they continue to feel relevant. But Tehrani points out that although this is often the case in Western versions, it is not always true elsewhere. In Chinese and Japanese versions, often known as The Tiger Grandmother, the villain is a woman, and in both Iran and Nigeria, the victim is a boy.</p>
                        <p>Mathias Clasen at Aarhus University in Denmark isn’t surprised by Tehrani’s findings. ‘Habits and morals change, but the things that scare us, and the fact that we seek out entertainment that’s designed to scare us – those are constant,’ he says. Clasen believes that scary stories teach us what it feels like to be afraid without having to experience real danger, and so build up resistance to negative emotions.</p>
                        <p class="text-sm italic">*Folklorists: those who study traditional stories</p>
                    </div>
                </div>
            </div>

            <!-- Questions Half (Right) -->
            <div class="questions-half">
                <!-- Passage 1 Questions -->
                <div id="passage1-questions" class="tab-content active">
                    <form id="form1">
                        <div class="question-group">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Questions 1-7</h4>
                            <p class="mb-4 selectable-text">Do the following statements agree with the claims of the writer? Write TRUE, FALSE, or NOT GIVEN.</p>
                            <div class="space-y-4">
                                <!-- Q1 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>1</b> On leaving school, Moore did what his father wanted him to do.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q1">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                                <!-- Q2 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>2</b> Moore was inspired by ancient art he saw in a museum outside London.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q2">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                                <!-- Q3 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>3</b> Moore was influenced by the work of the Spanish artist Pablo Picasso from the beginning of his career.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q3">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                                <!-- Q4 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>4</b> Moore's work from the 1930s was not popular with the British public.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q4">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                                <!-- Q5 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>5</b> Moore started teaching at the Chelsea School of Art in 1932.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q5">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                                <!-- Q6 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>6</b> Moore worked on the Harlow sculpture project in a studio in London.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q6">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                                <!-- Q7 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text"><b>7</b> Moore’s family sculpture marked a new, more naturalistic phase in his style.</p>
                                    <div class="tfng-btn-group flex space-x-2" data-question="q7">
                                        <button type="button" class="btn" data-value="TRUE">TRUE</button>
                                        <button type="button" class="btn" data-value="FALSE">FALSE</button>
                                        <button type="button" class="btn" data-value="NOT GIVEN">NOT GIVEN</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="question-group">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Questions 8-13</h4>
                            <p class="mb-4 selectable-text">Complete the summary below. Write NO MORE THAN TWO WORDS from the passage for each answer.</p>
                            <div class="space-y-4">
                                <!-- Q8 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text">When Moore’s exhibition was reviewed unfavourably by the press, he had to endure demands for his <b>8</b> <input type="text" class="short-answer-input" data-question="q8"> from the Royal College of Art. After a time, he moved to a farmhouse, where his artistic output was affected by a lack of <b>9</b> <input type="text" class="short-answer-input" data-question="q9">. While there, he focused on drawing and produced sketches of Londoners and also of the <b>10</b> <input type="text" class="short-answer-input" data-question="q10"> in his hometown of Castleford. A work for a town called Harlow, which depicted a <b>11</b> <input type="text" class="short-answer-input" data-question="q11">, demonstrated a change in his approach to sculpture. This project was a significant turning point in Moore’s career as it allowed his works to be sold to <b>12</b> <input type="text" class="short-answer-input" data-question="q12"> all over the world. The resulting boost to his <b>13</b> <input type="text" class="short-answer-input" data-question="q13"> made it possible for him to complete more challenging projects in the future.</p>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Passage 2 Questions -->
                <div id="passage2-questions" class="tab-content">
                    <form id="form2">
                        <div class="question-group">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Questions 14-20</h4>
                            <p class="mb-4 selectable-text">Reading Passage 2 has seven paragraphs, A-G. Choose the correct heading for paragraphs A, B, C, D, E, F, and G from the list of headings below.</p>
                            <div class="space-y-4">
                                <ul class="list-none space-y-2">
                                    <li><b>i</b> Desolenator’s future business prospects</li>
                                    <li><b>ii</b> The problem with a common water purification method</li>
                                    <li><b>iii</b> An idea for a machine that cleans water</li>
                                    <li><b>iv</b> A wide range of potential customers</li>
                                    <li><b>v</b> The device’s technical specifications</li>
                                    <li><b>vi</b> The reason the Desolenator was invented</li>
                                    <li><b>vii</b> A description of the Desolenator’s inventor</li>
                                    <li><b>viii</b> A major challenge for a large proportion of the world’s population</li>
                                    <li><b>ix</b> How the device is able to store energy</li>
                                    <li><b>x</b> A comparison between the Desolenator and other technologies</li>
                                </ul>
                                <div class="space-y-2">
                                    <!-- Q14 -->
                                    <div class="question-item flex items-center space-x-2">
                                        <p><b>14</b> Paragraph A</p>
                                        <select class="dropdown-select" data-question="q14">
                                            <option value="">Choose...</option>
                                            <option value="i">i</option>
                                            <option value="ii">ii</option>
                                            <option value="iii">iii</option>
                                            <option value="iv">iv</option>
                                            <option value="v">v</option>
                                            <option value="vi">vi</option>
                                            <option value="vii">vii</option>
                                            <option value="viii">viii</option>
                                            <option value="ix">ix</option>
                                            <option value="x">x</option>
                                        </select>
                                    </div>
                                    <!-- Q15 -->
                                    <div class="question-item flex items-center space-x-2">
                                        <p><b>15</b> Paragraph B</p>
                                        <select class="dropdown-select" data-question="q15">
                                            <option value="">Choose...</option>
                                            <option value="i">i</option>
                                            <option value="ii">ii</option>
                                            <option value="iii">iii</option>
                                            <option value="iv">iv</option>
                                            <option value="v">v</option>
                                            <option value="vi">vi</option>
                                            <option value="vii">vii</option>
                                            <option value="viii">viii</option>
                                            <option value="ix">ix</option>
                                            <option value="x">x</option>
                                        </select>
                                    </div>
                                    <!-- Q16 -->
                                    <div class="question-item flex items-center space-x-2">
                                        <p><b>16</b> Paragraph C</p>
                                        <select class="dropdown-select" data-question="q16">
                                            <option value="">Choose...</option>
                                            <option value="i">i</option>
                                            <option value="ii">ii</option>
                                            <option value="iii">iii</option>
                                            <option value="iv">iv</option>
                                            <option value="v">v</option>
                                            <option value="vi">vi</option>
                                            <option value="vii">vii</option>
                                            <option value="viii">viii</option>
                                            <option value="ix">ix</option>
                                            <option value="x">x</option>
                                        </select>
                                    </div>
                                    <!-- Q17 -->
                                    <div class="question-item flex items-center space-x-2">
                                        <p><b>17</b> Paragraph D</p>
                                        <select class="dropdown-select" data-question="q17">
                                            <option value="">Choose...</option>
                                            <option value="i">i</option>
                                            <option value="ii">ii</option>
                                            <option value="iii">iii</option>
                                            <option value="iv">iv</option>
                                            <option value="v">v</option>
                                            <option value="vi">vi</option>
                                            <option value="vii">vii</option>
                                            <option value="viii">viii</option>
                                            <option value="ix">ix</option>
                                            <option value="x">x</option>
                                        </select>
                                    </div>
                                    <!-- Q18 -->
                                    <div class="question-item flex items-center space-x-2">
                                        <p><b>18</b> Paragraph E</p>
                                        <select class="dropdown-select" data-question="q18">
                                            <option value="">Choose...</option>
                                            <option value="i">i</option>
                                            <option value="ii">ii</option>
                                            <option value="iii">iii</option>
                                            <option value="iv">iv</option>
                                            <option value="v">v</option>
                                            <option value="vi">vi</option>
                                            <option value="vii">vii</option>
                                            <option value="viii">viii</option>
                                            <option value="ix">ix</option>
                                            <option value="x">x</option>
                                        </select>
                                    </div>
                                    <!-- Q19 -->
                                    <div class="question-item flex items-center space-x-2">
                                        <p><b>19</b> Paragraph F</p>
                                        <select class="dropdown-select" data-question="q19">
                                            <option value="">Choose...</option>
                                            <option value="i">i</option>
                                            <option value="ii">ii</option>
                                            <option value="iii">iii</option>
                                            <option value="iv">iv</option>
                                            <option value="v">v</option>
                                            <option value="vi">vi</option>
                                            <option value="vii">vii</option>
                                            <option value="viii">viii</option>
                                            <option value="ix">ix</option>
                                            <option value="x">x</option>
                                        </select>
                                    </div>
                                    <!-- Q20 -->
                                    <div class="question-item flex items-center space-x-2">
                                        <p><b>20</b> Paragraph G</p>
                                        <select class="dropdown-select" data-question="q20">
                                            <option value="">Choose...</option>
                                            <option value="i">i</option>
                                            <option value="ii">ii</option>
                                            <option value="iii">iii</option>
                                            <option value="iv">iv</option>
                                            <option value="v">v</option>
                                            <option value="vi">vi</option>
                                            <option value="vii">vii</option>
                                            <option value="viii">viii</option>
                                            <option value="ix">ix</option>
                                            <option value="x">x</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="question-group">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Questions 21-26</h4>
                            <p class="mb-4 selectable-text">Complete the summary below. Write NO MORE THAN TWO WORDS from the passage for each answer.</p>
                            <div class="space-y-4">
                                <!-- Q21 -->
                                <div class="question-item">
                                    <p class="mb-2 selectable-text">The Desolenator is a device that is easy to move around because of its <b>21</b> <input type="text" class="short-answer-input" data-question="q21">. Water enters through a pipe and flows as a thin <b>22</b> <input type="text" class="short-answer-input" data-question="q22"> between a solar panel and a sheet of glass. A very simple <b>23</b> <input type="text" class="short-answer-input" data-question="q23"> is used to remove particles. There are two tubes that come out of the device, one for the purified water and one for the <b>24</b> <input type="text" class="short-answer-input" data-question="q24">. An LCD screen shows the <b>25</b> <input type="text" class="short-answer-input" data-question="q25"> of the unit and the information is sent to the company, which is then able to provide <b>26</b> <input type="text" class="short-answer-input" data-question="q26">.</p>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Passage 3 Questions -->
                <div id="passage3-questions" class="tab-content">
                    <form id="form3">
                        <div class="question-group">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Questions 27-32</h4>
                            <p class="mb-4 selectable-text">Reading Passage 3 has ten paragraphs, A-J. Which paragraph contains the following information?</p>
                            <div class="space-y-4">
                                <!-- Q27 -->
                                <div class="question-item flex items-center space-x-2">
                                    <p><b>27</b> A reference to the idea that fairy tales may be more fundamental than the characters they contain.</p>
                                    <input type="text" class="short-answer-input" data-question="q27">
                                </div>
                                <!-- Q28 -->
                                <div class="question-item flex items-center space-x-2">
                                    <p><b>28</b> Mention of the belief that fairy tales are a useful tool for giving children advice.</p>
                                    <input type="text" class="short-answer-input" data-question="q28">
                                </div>
                                <!-- Q29 -->
                                <div class="question-item flex items-center space-x-2">
                                    <p><b>29</b> An explanation of why the most memorable fairy tales have been repeated for many years.</p>
                                    <input type="text" class="short-answer-input" data-question="q29">
                                </div>
                                <!-- Q30 -->
                                <div class="question-item flex items-center space-x-2">
                                    <p><b>30</b> Details of the different forms a well-known fairy tale may take.</p>
                                    <input type="text" class="short-answer-input" data-question="q30">
                                </div>
                                <!-- Q31 -->
                                <div class="question-item flex items-center space-x-2">
                                    <p><b>31</b> A description of a scientific approach to the study of fairy tales.</p>
                                    <input type="text" class="short-answer-input" data-question="q31">
                                </div>
                                <!-- Q32 -->
                                <div class="question-item flex items-center space-x-2">
                                    <p><b>32</b> A reference to the claim that fairy tales may help people cope with difficult emotions.</p>
                                    <input type="text" class="short-answer-input" data-question="q32">
                                </div>
                            </div>
                        </div>
                        <div class="question-group">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Questions 33-36</h4>
                            <p class="mb-4 selectable-text">Complete each sentence with the correct ending, A-G, below.</p>
                            <div class="space-y-4">
                                <ul class="list-none space-y-2">
                                    <li><b>A</b> do not support the idea that cautionary elements are the most important part of a story.</li>
                                    <li><b>B</b> demonstrate that the most central parts of a story are the most stable.</li>
                                    <li><b>C</b> show that characters change less frequently than events.</li>
                                    <li><b>D</b> show that frightening details are more likely to be retained in a story than other details.</li>
                                    <li><b>E</b> are not surprised that gruesome details are so well-preserved in fairy tales.</li>
                                    <li><b>F</b> claim that stories about women as victims will always be relevant.</li>
                                    <li><b>G</b> challenge the idea that the main message of a story is the most important element.</li>
                                </ul>
                                <div class="space-y-2">
                                    <!-- Q33 -->
                                    <div class="question-item flex items-center space-x-2">
                                        <p><b>33</b> Tehrani’s first findings concerning a story’s core elements</p>
                                        <input type="text" class="short-answer-input" data-question="q33">
                                    </div>
                                    <!-- Q34 -->
                                    <div class="question-item flex items-center space-x-2">
                                        <p><b>34</b> Tehrani’s research into the cautionary elements of fairy tales</p>
                                        <input type="text" class="short-answer-input" data-question="q34">
                                    </div>
                                    <!-- Q35 -->
                                    <div class="question-item flex items-center space-x-2">
                                        <p><b>35</b> Tehrani’s study of the most frightening parts of a story</p>
                                        <input type="text" class="short-answer-input" data-question="q35">
                                    </div>
                                    <!-- Q36 -->
                                    <div class="question-item flex items-center space-x-2">
                                        <p><b>36</b> Jack Zipes and Mathias Clasen</p>
                                        <input type="text" class="short-answer-input" data-question="q36">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="p-4 bg-gray-100 flex justify-center sticky bottom-0 z-10 border-t">
            <button id="submit-test-button" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-colors duration-200">
                Submit Test
            </button>
        </div>
    </div>

    <script>
        // Use window.jsPDF to ensure compatibility with the jsPDF UMD module
        const { jsPDF } = window.jspdf;

        // Correct Answer Key
        const correctAnswers = {
            // Passage 1
            q1: 'TRUE',
            q2: 'FALSE',
            q3: 'NOT GIVEN',
            q4: 'TRUE',
            q5: 'NOT GIVEN',
            q6: 'FALSE',
            q7: 'TRUE',
            q8: 'resignation',
            q9: 'materials',
            q10: 'miners',
            q11: 'family',
            q12: 'collectors',
            q13: 'income',
            // Passage 2
            q14: 'iii',
            q15: 'vi',
            q16: 'v',
            q17: 'x',
            q18: 'iv',
            q19: 'viii',
            q20: 'i',
            q21: 'wheels',
            q22: 'film',
            q23: 'filter',
            q24: 'waste',
            q25: 'performance',
            q26: 'servicing',
            // Passage 3
            q27: 'E',
            q28: 'B',
            q29: 'H',
            q30: 'A',
            q31: 'D',
            q32: 'J',
            q33: 'G',
            q34: 'A',
            q35: 'D',
            q36: 'E',
            q37: 'B',
            q38: 'D',
            q39: 'A',
            q40: 'A'
        };


        let timerInterval;

        function openTab(evt, tabId) {
            // Declare all variables
            var i, tabcontent, tabbuttons;

            // Get all elements with class="tab-content" and hide them
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }

            // Get all elements with class="tab-button" and remove the class "active"
            tabbuttons = document.getElementsByClassName("tab-button");
            for (i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].className = tabbuttons[i].className.replace(" active", "");
            }

            // Show the current tab, and add an "active" class to the button that opened the tab
            document.getElementById(tabId + '-questions').style.display = "block";
            document.getElementById(tabId + '-text').style.display = "block";
            evt.currentTarget.className += " active";
        }

        // Initialize tabs to show the first one
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelector('.tab-button').click();
            startTimer();
        });

        // Event listeners for True/False/Not Given buttons
        document.querySelectorAll('.tfng-btn-group').forEach(group => {
            group.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    // Remove 'selected' class from all buttons in the same group
                    group.querySelectorAll('.btn').forEach(btn => btn.classList.remove('selected'));
                    // Add 'selected' class to the clicked button
                    e.target.classList.add('selected');
                }
            });
        });

        let highlightToolbar = document.getElementById('highlight-toolbar');
        let selectedText = '';
        let passageContainer;

        // Universal highlight and unhighlight functionality
        document.querySelectorAll('.selectable-text').forEach(container => {
            container.addEventListener('mouseup', (e) => {
                const selection = window.getSelection();
                selectedText = selection.toString().trim();
                passageContainer = container;

                if (selectedText.length > 0 && !selection.isCollapsed) {
                    const range = selection.getRangeAt(0);
                    const rect = range.getBoundingClientRect();
                    
                    highlightToolbar.style.top = `${rect.top + window.scrollY - 40}px`;
                    highlightToolbar.style.left = `${rect.left + window.scrollX + (rect.width / 2) - (highlightToolbar.offsetWidth / 2)}px`;
                    highlightToolbar.style.display = 'block';
                } else {
                    highlightToolbar.style.display = 'none';
                }
            });
        });

        document.getElementById('highlight-btn').addEventListener('click', () => {
            const selection = window.getSelection();
            if (selection.toString().trim().length > 0) {
                const range = selection.getRangeAt(0);
                const mark = document.createElement('mark');
                mark.textContent = range.toString();
                range.deleteContents();
                range.insertNode(mark);
                window.getSelection().removeAllRanges();
            }
            highlightToolbar.style.display = 'none';
        });

        // Global click listener to hide the toolbar
        document.addEventListener('click', (e) => {
            if (!highlightToolbar.contains(e.target) && !e.target.closest('.selectable-text')) {
                highlightToolbar.style.display = 'none';
            }
        });


        function generatePdfReport() {
            // New jsPDF instance
            const doc = new jsPDF();
            doc.setFontSize(18);
            doc.text('IELTS Reading Test Results', 14, 20);

            doc.setFontSize(12);
            let y = 30;

            const tableData = [];
            let score = 0;
            let totalQuestions = 0;

            // Gather all answers
            document.querySelectorAll('form').forEach(form => {
                const formId = form.id;
                
                // TRUE/FALSE/NOT GIVEN
                form.querySelectorAll('.tfng-btn-group').forEach(group => {
                    const questionId = group.dataset.question;
                    const selectedBtn = group.querySelector('.btn.selected');
                    const userAnswer = selectedBtn ? selectedBtn.dataset.value : 'Not Answered';
                    const correctAnswer = correctAnswers[questionId];
                    const isCorrect = (userAnswer.toLowerCase() === correctAnswer.toLowerCase());
                    if (isCorrect) score++;
                    totalQuestions++;
                    tableData.push([questionId.toUpperCase(), userAnswer, correctAnswer, isCorrect ? 'Correct' : 'Incorrect']);
                });

                // Short Answer
                form.querySelectorAll('.short-answer-input').forEach(input => {
                    const questionId = input.dataset.question;
                    const userAnswer = input.value.trim();
                    const correctAnswer = correctAnswers[questionId];
                    const isCorrect = (userAnswer.toLowerCase() === correctAnswer.toLowerCase());
                    if (isCorrect) score++;
                    totalQuestions++;
                    tableData.push([questionId.toUpperCase(), userAnswer, correctAnswer, isCorrect ? 'Correct' : 'Incorrect']);
                });

                // Dropdowns
                form.querySelectorAll('.dropdown-select').forEach(select => {
                    const questionId = select.dataset.question;
                    const userAnswer = select.value;
                    const correctAnswer = correctAnswers[questionId];
                    const isCorrect = (userAnswer.toLowerCase() === correctAnswer.toLowerCase());
                    if (isCorrect) score++;
                    totalQuestions++;
                    tableData.push([questionId.toUpperCase(), userAnswer, correctAnswer, isCorrect ? 'Correct' : 'Incorrect']);
                });
            });

            // Add summary table to PDF
            doc.autoTable({
                startY: y,
                head: [['Question', 'Your Answer', 'Correct Answer', 'Result']],
                body: tableData,
                styles: { fontSize: 8 },
                headStyles: { fillColor: [240, 240, 240], textColor: [0, 0, 0] },
                alternateRowStyles: { fillColor: [248, 248, 248] },
                margin: { top: 10 }
            });

            // Add score to the end of the PDF
            y = doc.autoTable.previous.finalY + 10;
            doc.text(`Final Score: ${score}/${totalQuestions}`, 14, y);
            
            return doc;
        }
        
        function freezeAllForms() {
             document.querySelectorAll('form').forEach(form => form.classList.add('frozen-form'));
             document.getElementById('submit-test-button').disabled = true;
        }

        function endTest() {
            clearInterval(timerInterval);
            const timerContainer = document.getElementById('timer-container');
            timerContainer.textContent = "Time's Up!";
            timerContainer.classList.add('ended');
            const doc = generatePdfReport();
            doc.save('IELTS_Reading_Test_3_Results.pdf');
            freezeAllForms();
        }

        function startTimer() {
            let timeLeft = 60 * 60; // 60 minutes in seconds
            const countdownEl = document.getElementById('countdown');

            timerInterval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                countdownEl.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

                if (timeLeft <= 0) {
                    endTest();
                }
            }, 1000);
        }

        document.getElementById('submit-test-button').addEventListener('click', endTest);
        
        document.addEventListener('DOMContentLoaded', startTimer);

    </script>
</body>
</html>
